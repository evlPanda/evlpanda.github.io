---
layout: post
title: HP Quality Center (QC)
date: 2010-03-30 06:09:00.000000000 +11:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- http://schemas.google.com/blogger/2008/kind#post
tags: []
meta:
  blogger_blog: capital-it.blogspot.com
  blogger_author: Michael Nitschke
  blogger_0c9a3d51488c214aefd1a54a659341d6_permalink: '8884367675601826898'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p>In case I'm ever asked to export from QC again.</p>
<pre style="font-family:Andale Mono, Lucida Console, Monaco, fixed, monospace;color:#000000;background-color:#eee;font-size:12px;border:1px dashed #999999;line-height:14px;padding:5px;overflow:auto;width:100%;"><code><br />/*<br />Built for Jira 26921<br />Michael Nitschke 30/03/2010<br /><br />Examples:<br />define testPlanRoot = 'SA Master'<br />define testLabRoot = 'System Testing\SYS1 SA'<br /><br />define testPlanRoot = 'MTP Testing'<br />define testLabRoot = 'MTP Testing\MTP 13'<br /><br />Hint: you can optionally add a trailing back-slash on the testLabRoot variable if you<br />need to clearly define it as seperate from and similarly named folder,<br />e.g. 'SYSTEM' and 'SYSTEM1'.<br />*/<br /><br />/* notes:<br />Test Lab runs do not neccessarily line up in the same folders in Test Lab as the folders that are in Test Plan ...if that makes sense.<br />Joined by TEST_ID but the Test Lab folder Name can be changed, so the lab results for a given test plan may be in a test lab folder that has a different name to the plan.<br />hard to explain.<br />*/<br /><br />define testPlanRoot = 'SA Master'<br />define testLabRoot = 'System Testing\System Test Phase 1 - SA
<br /><br /><br />select * from (<br /><br />SELECT<br />  substr(path, 2, instr(path,'
,1,2) - 2) as lev1<br />, substr(path, instr(path,'
,1,2) + 1, instr(path,'
,1,3) - instr(path,'
,1,2) - 1) as lev2<br />, substr(path, instr(path,'
,1,3) + 1, instr(path,'
,1,4) - instr(path,'
,1,3) - 1) as lev3<br />, substr(path, instr(path,'
,1,4) + 1, instr(path,'
,1,5) - instr(path,'
,1,4) - 1) as lev4<br />, substr(path, instr(path,'
,1,5) + 1, instr(path,'
,1,6) - instr(path,'
,1,5) - 1) as lev5<br />, substr(path, instr(path,'
,1,6) + 1, instr(path,'
,1,7) - instr(path,'
,1,6) - 1) as lev6<br />, nvl(users.full_name, 'anon.') || ' (' || test.ts_responsible || ')' as sweet_fa<br />, test.ts_name as test_script_name<br />, test.ts_status<br />, run.rn_status<br /><br />from (<br /> select<br /> al_father_id, al_item_id, sys_connect_by_path(al_description, '
) || '
 as path<br /> FROM (SELECT * from all_lists where al_father_id  2329) -- 2329 is a 'bad', invisible folder. Yes really.<br /> connect by prior al_item_id = al_father_id<br />) path<br />, test<br />, users<br />,<br /> (select run.rn_test_id, run.rn_status<br /> from run<br /> where exists<br />  (select 1<br />  from cycle<br />  where cycle.cy_cycle_id = run.rn_cycle_id<br />  and cycle.cy_folder_id in<br />   (select cf_item_id from<br />    (select cf_item_id, sys_connect_by_path(cf_item_name, '
) as path<br />    from cycl_fold a<br />    connect by prior cf_item_id = cf_father_id)<br />   where path like '
 || &amp;testLabRoot || '%'))<br /> and run.rn_execution_date =<br />  (select max(r.rn_execution_date)<br />  from run r<br />  where r.rn_test_id = run.rn_test_id)<br /> and run.rn_execution_time =<br />  (select max(rn_execution_time)<br />  from run r<br />  where r.rn_test_id = run.rn_test_id<br />  and r.rn_execution_date = run.rn_execution_date)) run<br /><br /><br />where path.path like '
 || &amp;testPlanRoot || '%'<br /><br />and test.ts_subject (+) = path.al_item_id<br />and users.user_name (+) = test.ts_responsible<br /><br />and run.rn_test_id (+) = test.ts_test_id<br /><br />)<br />where lev1 = &amp;testPlanRoot -- Removes data where same folder name exists on another branch.<br />and not lev2 is null -- Don't need base folder only in data (blanks).<br />and not lev3 is null<br />order by 1, 2, 3, 4, 5, 6, 8<br />;<br /><br /><br /></code></pre>
