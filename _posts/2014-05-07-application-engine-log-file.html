---
layout: post
title: Application Engine Log File
date: 2014-05-07 01:41:00.000000000 +10:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags: []
meta:
  blogger_blog: capital-it.blogspot.com
  blogger_author: Michael Nitschke
  blogger_0c9a3d51488c214aefd1a54a659341d6_permalink: '2448844955144747257'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p>Handy little library to open Application Engine log files, based on whether running on client while developing, or on server.<br /> 
<pre><code><br />class FuncLib<br />   method isTestingMode(&amp;iProcessInst As integer) Returns boolean;<br />   method GetFile(&amp;bTesting As boolean, &amp;sFilename As string, &amp;sMode As string) Returns File;<br />end-class;<br /><br /><br />/**********************************************************************<br /> * Returns whether app engine is in test mode (running locally).      *<br /> * -------------------------------------------------------------------*<br /> * Parameters  : &amp;numProcessInst (process instance)               *<br /> * Returns   : True if running locally, otherwise false.              *<br /> **********************************************************************/<br />method isTestingMode<br />   /+ &amp;iProcessInst as Integer +/<br />   /+ Returns Boolean +/<br />   Local boolean &amp;bExists, &amp;bTestMode;<br />   <br />   /* Check if process instance exists in a process scheduler table */<br />   SQLExec("SELECT 1 FROM PSPRCSRQST WHERE PRCSINSTANCE = :1", &amp;iProcessInst, &amp;bExists);<br />   <br />   If Not &amp;bExists Then<br />      /* If not, then its running in test mode. */<br />      &amp;bTestMode = True;<br />   End-If;<br />   <br />   Return &amp;bTestMode;<br />end-method;<br /><br /><br />/**********************************************************************<br /> * This method creates/opens a log file when running an app engine    *<br /> * in either 2 (testing) or n tier mode.                              *<br /> * -------------------------------------------------------------------*<br /> * Parameters                                                         *<br /> *   Parm 1:  Boolean - Testing mode?                                 *<br /> *   Parm 2:  File name                                               *<br /> *   Parm 3:  Mode: "W" will create a new file for writing,           *<br /> *                       "A" will append to an existing file.         *<br /> * Returns : File                                                     *<br /> **********************************************************************/<br />method GetFile<br />   /+ &amp;bTesting as Boolean, +/<br />   /+ &amp;sFilename as String, +/<br />   /+ &amp;sMode as String +/<br />   /+ Returns File +/<br />   <br />   Local string &amp;sPath;<br />   Local File &amp;fFile;<br />   <br />   If &amp;bTesting Then<br />      &amp;sPath = "C:\TEMP\";<br />      &amp;fFile = GetFile(&amp;sPath | &amp;sFilename, &amp;sMode, %FilePath_Absolute);<br />   Else<br />      &amp;sPath = "";<br />      &amp;fFile = GetFile(&amp;sFilename, &amp;sMode);<br />   End-If;<br />   <br />   If &amp;sMode = "W" Then<br />      MessageBox(0, "", 0, 0, "Creating file:  %1", &amp;sPath | &amp;sFilename);<br />   End-If;<br />   <br />   Return &amp;fFile<br />end-method;<br /></code></pre>
<p> And to use:
<pre><code><br />import YOUR_PACKAGE:Utilities:FuncLib:*;<br /><br />Component File &amp;logFile;<br /><br />&amp;cbTestingMode = (create YOUR_PACKAGE:Utilities:FuncLib()).isTestingMode(YOUR_STATE_RECORD_AET.PROCESS_INSTANCE);<br />&amp;logFile = (create YOUR_PACKAGE:Utilities:FuncLib()).GetFile(&amp;cbTestingMode, "log.txt", "W");<br /></code></pre>
