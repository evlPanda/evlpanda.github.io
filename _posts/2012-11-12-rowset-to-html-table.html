---
layout: post
title: Rowset to HTML Table
date: 2012-11-12 22:51:00.000000000 +11:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags: []
meta:
  blogger_blog: capital-it.blogspot.com
  blogger_author: Michael Nitschke
  blogger_0c9a3d51488c214aefd1a54a659341d6_permalink: '7836324498270203330'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p>Another possibly useless tool:</p>
<pre style="font-family:Andale Mono, Lucida Console, Monaco, fixed, monospace;color:#000000;background-color:#eee;font-size:12px;border:1px dashed #999999;line-height:14px;padding:5px;overflow:auto;width:100%;"><code>&lt;*--------------------------------------------------------------------------<br /><br /> UNSW WUHR005 Michael Nitschke 12/11/2012<br /> Utility to take a rowset and return all its values.<br /> At time of writing only handles a single record, flat rowset.<br /><br /> Example:<br /><br />   import NS_NEXTGEN:Utilities:RowsetToHTML;<br /><br />   /* Create and fill a rowset. */<br />   Local Rowset &amp;rowset = CreateRowset(Record.SOME_RECORD);<br />   &amp;rowset.Fill();<br /><br />   /* Put the rowset's data into an HTML Area on a Page. */<br />   Local NS_NEXTGEN:Utilities:RowsetToHTML &amp;rs2HTML = create NS_NEXTGEN:Utilities:RowsetToHTML(&amp;rowset);<br />   NS_DERIVED.HTML_AREA_01.Value = &amp;rs2HTML.RowsetAsHTML;<br /><br /> The above will populate a HTML Area on a page with the values of the rowset.<br /> This utility could be extended to include heirarchical data.<br /><br />----------------------------------------------------------------------------*&gt;<br /><br />class RowsetToHTML<br />   method RowsetToHTML(&amp;rs As Rowset);<br />   property string RowsetAsHTML;<br />end-class;<br /><br />method RowsetToHTML<br />   /+ &amp;rs as Rowset +/<br />   <br />   Local string &amp;style;<br />   &amp;style = &amp;style | "";<br />   &amp;style = &amp;style | "table.rowset {";<br />   &amp;style = &amp;style | "    border-width: 3px;";<br />   &amp;style = &amp;style | "    border-spacing: 0px;";<br />   &amp;style = &amp;style | "    border-style: solid;";<br />   &amp;style = &amp;style | "    border-color: black;";<br />   &amp;style = &amp;style | "    border-collapse: collapse;";<br />   &amp;style = &amp;style | "    background-color: white;";<br />   &amp;style = &amp;style | "}";<br />   &amp;style = &amp;style | "table.rowset th {";<br />   &amp;style = &amp;style | "    border-width: 1px;";<br />   &amp;style = &amp;style | "    padding: 4px;";<br />   &amp;style = &amp;style | "    border-style: dotted;";<br />   &amp;style = &amp;style | "    border-color: gray;";<br />   &amp;style = &amp;style | "    background-color: rgb(200, 200, 200);";<br />   &amp;style = &amp;style | "    -moz-border-radius: ;";<br />   &amp;style = &amp;style | "    font-size: small ;";<br />   &amp;style = &amp;style | "}";<br />   &amp;style = &amp;style | "table.rowset th.recname {";<br />   &amp;style = &amp;style | "    background-color: rgb(0, 0, 0);";<br />   &amp;style = &amp;style | "    color: white;";<br />   &amp;style = &amp;style | "    font-size: large;";<br />   &amp;style = &amp;style | "    font-weight: normal;";<br />   &amp;style = &amp;style | "    text-align: left;";<br />   &amp;style = &amp;style | "}";<br />   &amp;style = &amp;style | "table.rowset tr.r0 td {";<br />   &amp;style = &amp;style | "    background-color: rgb(240, 240, 240);";<br />   &amp;style = &amp;style | "}";<br />   &amp;style = &amp;style | "table.rowset tr.r1 td {";<br />   &amp;style = &amp;style | "    background-color: rgb(250, 250, 250);";<br />   &amp;style = &amp;style | "}";<br />   &amp;style = &amp;style | "table.rowset td {";<br />   &amp;style = &amp;style | "    border-width: 1px;";<br />   &amp;style = &amp;style | "    padding: 4px;";<br />   &amp;style = &amp;style | "    border-style: dotted;";<br />   &amp;style = &amp;style | "    border-color: gray;";<br />   &amp;style = &amp;style | "    background-color: white;";<br />   &amp;style = &amp;style | "    -moz-border-radius: ;";<br />   &amp;style = &amp;style | "    font-size: small ;";<br />   &amp;style = &amp;style | "}";<br />   &amp;style = &amp;style | "";<br />   <br />   Local string &amp;html;<br />   &amp;html = &amp;html | "<table>";</table><br />   &amp;html = &amp;html | "<tr>";</tr><br />   &amp;html = &amp;html | "<th>" | &amp;rs(1).GetRecord(1).Name | "</th>";<br />   &amp;html = &amp;html | "";<br />   &amp;html = &amp;html | "<tr>";</tr><br />   Local integer &amp;f;<br />   &amp;html = &amp;html | "<th>row</th>";<br />   For &amp;f = 1 To &amp;rs(1).GetRecord(1).FieldCount<br />      &amp;html = &amp;html | "<th>" | &amp;rs(1).GetRecord(1).GetField(&amp;f).Name | "</th>";<br />   End-For;<br />   &amp;html = &amp;html | "";<br />   Local string &amp;alternate = "1";<br />   Local integer &amp;i;<br />   For &amp;i = 1 To &amp;rs.RowCount<br />      If &amp;alternate = "1" Then<br />         &amp;alternate = "0";<br />      Else<br />         &amp;alternate = "1";<br />      End-If;<br />      &amp;html = &amp;html | "<tr>";</tr><br />      &amp;html = &amp;html | "<td>" | &amp;i | "</td>";<br />      For &amp;f = 1 To &amp;rs(&amp;i).GetRecord(1).FieldCount<br />         &amp;html = &amp;html | "<td>" | &amp;rs(&amp;i).GetRecord(1).GetField(&amp;f).Value | "</td>";<br />      End-For;<br />      &amp;html = &amp;html | "";<br />   End-For;<br />   &amp;html = &amp;html | "";<br />   <br />   %This.RowsetAsHTML = &amp;style | &amp;html;<br />   <br />end-method;<br /></code></pre>
