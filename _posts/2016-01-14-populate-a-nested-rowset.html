---
layout: post
title: Populate a Nested Rowset
date: 2016-01-14 03:45:14.000000000 +11:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags: []
meta:
  _rest_api_published: '1'
  _rest_api_client_id: "-1"
  _publicize_job_id: '18728917009'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p>Generic population of a given rowset that is nested/hierarchical.</p>
<pre>
method PopulateRowset
   /+ &amp;rowset as Rowset, +/
   /+ &amp;recSearch as Record +/

   Local integer &amp;i, &amp;c;
   Local string &amp;value, &amp;where;
   
   /* Populate this level. */
   &amp;where = "where ";
   For &amp;i = 1 To &amp;recSearch.FieldCount
      If &amp;recSearch.GetField(&amp;i).IsKey And
            All(&amp;recSearch.GetField(&amp;i).Value) Then
         /* Urgh. (still have to do date) */
         Evaluate &amp;recSearch.GetField(&amp;i).Type
         When = "CHAR"
            &amp;value = "'" | &amp;recSearch.GetField(&amp;i).Value | "'";
         When-Other
            &amp;value = &amp;recSearch.GetField(&amp;i).Value;
         End-Evaluate;
         &amp;where = &amp;where | &amp;recSearch.GetField(&amp;i).Name | " = " | &amp;value | " and ";
      End-If;
   End-For;
   &amp;where = Left(&amp;where, Len(&amp;where) - 5); /* trim off last ' and '. */
   &amp;rowset.Fill(&amp;where);
   
   /* Populate all child levels. */
   For &amp;i = 1 To &amp;rowset.ActiveRowCount
      For &amp;c = 1 To &amp;rowset(&amp;i).ChildCount
         %This.PopulateRowset(&amp;rowset(&amp;i).GetRowset(&amp;c), &amp;rowset(&amp;i).GetRecord(1));
      End-For;
   End-For;
   
end-method;
</pre>
