---
layout: post
title: Using Outer Joins AND Effective Dated Logic
date: 2008-01-16 06:19:00.000000000 +11:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- sql join null effdt outer
tags: []
meta:
  blogger_blog: capital-it.blogspot.com
  blogger_author: Michael Nitschke
  blogger_0c9a3d51488c214aefd1a54a659341d6_permalink: '5548580776677229339'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p>How can you use outer joins on a table and still use effective dated logic?  Something like this. </p>
<p>Note that the outer join will either return no rows, and thus a NULL value for EFFDT, or it will return a date and subsequent effective dated logic can be used.<br /><!-- code formatted by http://manoli.net/csharpformat/ -->r /&gt;.csharpcode, .csharpcode pre<br />{<br /> font-size: small;<br /> color: black;<br /> font-family: Consolas, "Courier New", Courier, Monospace;<br /> background-color: #ffffff;<br /> /*white-space: pre;*/<br />}</p>
<p>.csharpcode pre { margin: 0em; }</p>
<p>.csharpcode .rem { color: #008000; }</p>
<p>.csharpcode .kwrd { color: #0000ff; }</p>
<p>.csharpcode .str { color: #006080; }</p>
<p>.csharpcode .op { color: #0000c0; }</p>
<p>.csharpcode .preproc { color: #cc6633; }</p>
<p>.csharpcode .asp { background-color: #ffff00; }</p>
<p>.csharpcode .html { color: #800000; }</p>
<p>.csharpcode .attr { color: #ff0000; }</p>
<p>.csharpcode .alt <br />{<br /> background-color: #f4f4f4;<br /> width: 100%;<br /> margin: 0em;<br />}</p>
<p>.csharpcode .lnum { color: #606060; }</p>
<pre class="csharpcode"><span class="kwrd">AND</span> C.BUSINESS_UNIT (+) = A.BUSINESS_UNIT<br /><span class="kwrd">AND</span> C.COMMON_ID (+) = A.COMMON_ID<br /><span class="kwrd">AND</span> C.SA_ID_TYPE (+) = A.SA_ID_TYPE<br /><span class="kwrd">AND</span> C.ITEM_NBR_CHARGE (+) = A.ITEM_NBR<br /><span class="kwrd">AND</span><br />   (<span class="kwrd">NULL</span> = C.EFFDT<br />   <span class="kwrd">OR</span><br />       (C.EFFDT =<br />           (<span class="kwrd">SELECT</span> <span class="kwrd">MAX</span>(C_ED.EFFDT)<br />           <span class="kwrd">FROM</span> sysadm.ps_ITEM_XREF C_ED<br />           <span class="kwrd">WHERE</span> C_ED.BUSINESS_UNIT = C.BUSINESS_UNIT<br />           <span class="kwrd">AND</span> C_ED.COMMON_ID = C.COMMON_ID<br />           <span class="kwrd">AND</span> C_ED.SA_ID_TYPE = C.SA_ID_TYPE<br />           <span class="kwrd">AND</span> C_ED.ITEM_NBR_CHARGE = C.ITEM_NBR_CHARGE<br />           <span class="kwrd">AND</span> C_ED.ITEM_NBR_PAYMENT = C.ITEM_NBR_PAYMENT<br />           <span class="kwrd">AND</span> C_ED.EFFDT &lt;= SYSDATE)))</pre>
