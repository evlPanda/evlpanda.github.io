---
layout: post
title: XML / BI Publisher Example, using XML File as the Data Source
date: 2011-05-02 05:26:00.000000000 +10:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- '"XML Publisher"'
tags: []
meta:
  blogger_blog: capital-it.blogspot.com
  blogger_author: Michael Nitschke
  blogger_0c9a3d51488c214aefd1a54a659341d6_permalink: '4062584307166878791'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p>Note that using a Data Source of "XMLDoc" or "RowSet" has been deprecated. If you are going to create a new XML Publisher Report you are going to have to use a data source of "XML File" or "PS Query".</p>
<p>This is probably a good way of going about it anyway because you need to create the XML and XSD files before you can create the template anyway (unless you want to make them by hand).</p>
<p>Following is a simple example that could use some flourish, but illustrates the method clearly.</p>
<pre style="background-color:#eeeeee;border:1px dashed #999999;color:black;font-family:Andale Mono, Lucida Console, Monaco, fixed, monospace;font-size:12px;line-height:14px;overflow:auto;padding:5px;width:100%;"><code><br /><br />/* Super simple example of creating a XML Publisher report based on RowSet data.<br />   Note that producing reports from RowSet data or XMLDoc data has been deprecated.<br />   This example uses a Data Source of 'XML File'. */<br /><br />import PSXP_XMLGEN:*;<br />import PSXP_RPTDEFNMANAGER:*;<br /><br /><br />/* Create Rowset(s) data for the report, however you need. */<br />Local Rowset &amp;rsData = CreateRowset(Record.AMS_SOA_PROG_VW);<br />&amp;rsData.Fill("WHERE EMPLID LIKE '3064%'");<br /><br /><br />Local string &amp;sFileNameXSD = "Rowset.xsd";<br />Local string &amp;sFileNameXML = "Rowset.xml";<br />Local string &amp;sRptDefn = "AMS_SOA_XML";<br />Local string &amp;sReportTemplate = "AMS_SOA_XML_1";<br /><br />/* Create XSD file. */<br />Local PSXP_XMLGEN:RowSetDS &amp;oXML_GENERATOR = create psxp_xmlgen:RowSetDS();<br />Local string &amp;my_schema = &amp;oXML_GENERATOR.getXSDSchema(&amp;rsData);<br />Local File &amp;XSD_File = GetFile(&amp;sFileNameXSD, "W");<br />&amp;XSD_File.WriteLine(&amp;my_schema);<br />&amp;XSD_File.Close();<br /><br />/* Create XML file. */<br />Local string &amp;my_xml = &amp;oXML_GENERATOR.getXMLData(&amp;rsData, "");<br />Local File &amp;XML_File = GetFile(&amp;sFileNameXML, "W");<br />&amp;XML_File.WriteLine(&amp;my_xml);<br />Local string &amp;xmlFileName = &amp;XML_File.Name; /* File.Name not available after File.Close() */<br />&amp;XML_File.Close();<br /><br /><br />/* Generate the report. */<br />&amp;oRptDefn = create PSXP_RPTDEFNMANAGER:ReportDefn(&amp;sRptDefn); /* report definition name */<br />&amp;oRptDefn.Get();<br />&amp;oRptDefn.SetRuntimeDataXMLFile(&amp;xmlFileName); /* Connect report and data. */<br />&amp;oRptDefn.ProcessReport(&amp;sRptTemplate, %Language_User, %Date, ""); /* report's template ID */<br />&amp;oRptDefn.OutDestination = %FilePath;<br /><br />/* Publish to Report Manager. */<br />&amp;oRptDefn.Publish("", "", "", AMS_SOA_AET.PROCESS_INSTANCE);<br /><br /><br /></code></pre>
