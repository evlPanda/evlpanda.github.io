---
layout: post
title: SQL - Multiple rows into one. Transpose SQL Results.
date: 2007-02-01 06:04:00.000000000 +11:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- Column
- http://schemas.google.com/blogger/2008/kind#post
- Multiple
- One
- Rows
tags: []
meta:
  blogger_blog: capital-it.blogspot.com
  blogger_author: Michael Nitschke
  blogger_0c9a3d51488c214aefd1a54a659341d6_permalink: '270677201402569890'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p>I've got Table.Person and Table.Pet.  Each person has multiple pets.</p>
<p>How do I return one row for each person with all their pets comma delimited in one column?<br /><code><br /><span style="font-size:85%;">SELECT<br />PERSON_ID<br />, TRIM(',' FROM TRIM(' ' FROM<br />MAX(DECODE(SEQ, 1, PET_NAME || ', ')) ||<br />MAX(DECODE(SEQ, 2, PET_NAME || ', ')) ||<br />MAX(DECODE(SEQ, 3, PET_NAME || ', ')) ||<br />MAX(DECODE(SEQ, 4, PET_NAME || ', ')) ||<br />MAX(DECODE(SEQ, 5, PET_NAME || ', ')) ||<br />MAX(DECODE(SEQ, 6, PET_NAME || ', ')) ||<br />MAX(DECODE(SEQ, 7, PET_NAME || ', ')) ||<br />MAX(DECODE(SEQ, 8, PET_NAME || ', ')) ||<br />MAX(DECODE(SEQ, 9, PET_NAME || ', ')) ||<br />MAX(DECODE(SEQ, 10, PET_NAME || ', '))<br />)) AS PET_NAMES<br />FROM<br /> (SELECT<br />   A.PERSON_ID<br /> , A.NAME AS PERSON_NAME<br /> , B.NAME AS PET_NAME<br /> , ROW_NUMBER() OVER (PARTITION BY PERSON_ID ORDER BY PERSON_ID DESC) SEQ<br /> FROM<br />   PERSON A<br /> , PET B<br /> WHERE B.PERSON_ID = A.PERSON_ID)<br />GROUP BY PERSON_ID</span></code></p>
