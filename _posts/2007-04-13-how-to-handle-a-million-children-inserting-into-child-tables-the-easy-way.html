---
layout: post
title: How to handle a million children - Inserting into child tables the easy way.
date: 2007-04-13 02:17:00.000000000 +10:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- child
- Dynamic
- PeopleCode
- Table
tags: []
meta:
  blogger_blog: capital-it.blogspot.com
  blogger_author: Michael Nitschke
  blogger_0c9a3d51488c214aefd1a54a659341d6_permalink: '8170429575455985048'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p>There are some situations where you want to insert a new EFFDT programatically into a parent row and also all of its child rows.  Note you could also blend this with another article on this blog: <a href="http://michaelnitschke.blogspot.com/2007/02/sql-finding-all-child-records-for-given.html">SQL - Finding all child records for a given record.</a></p>
<p>Rather than write out a bunch of SQLExec statements complete with a list of fields that have to be maintainted each time you add a field to a child record you can get PeopleCode to do all the work, like this:</p>
<p><span style="font-size:85%;"><br /><code>    <br />&amp;arrRecs = Split("TABLE_A,TABLE_B,TABLE_C", ",");<br />For &amp;i = 1 To &amp;arrRecs.len</p>
<p>   Local string &amp;recName = &amp;arrRecs [&amp;i];</p>
<p>      /* Get all rows for the parent/child record and process them. */<br />      Local Rowset &amp;rs = CreateRowset(@("Record." | &amp;recName));<br />      &amp;rs.Fill("WHERE KEY_FIELD_1 = :1<br />                AND FILL.EFFDT =<br />                   (SELECT MAX(F_ED.EFFDT)<br />                   FROM %Table(" | &amp;recName | ") F_ED<br />                   WHERE F_ED.KEY_FIELD_1 = FILL.KEY_FIELD_1)"<br />                , &amp;keyValue);<br />      For &amp;j = 1 To &amp;rs.ActiveRowCount</p>
<p>      /* New Effective date for the row and insert. */<br />      Local Record &amp;rec = &amp;rs(&amp;j).GetRecord(@("Record." | &amp;recName));<br />      &amp;rec.EFFDT.Value = AddToDate(%Date, 0, 0, 1);<br />      &amp;rec.Insert();</p>
<p>   End-For;</p>
<p>End-For;<br /></code><br /></span></p>
<p><span style="font-size:100%;">You could use the other post to dynamically create the list of child tables if you wish.</span></p>
