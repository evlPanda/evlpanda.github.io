---
layout: post
title: Array example
date: 2008-01-10 04:16:00.000000000 +11:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- array peoplecode
tags: []
meta:
  blogger_blog: capital-it.blogspot.com
  blogger_author: Michael Nitschke
  blogger_0c9a3d51488c214aefd1a54a659341d6_permalink: '4152088019016298416'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p>Nice little example of using arrays in PeopleCode.  Probably a more elegant, 2 dimension solution but this works just fine.</p>
<p>This example was required to handle overriding GL distribution by Elements, which are on level 3.  and element can appear on level 3 under many level 2 rows.  Code loops through <span style="font-weight:bold;">all</span> possible rows on level 3 and sums total for each unique Element found.  Must add to 100.
<pre class="csharpcode"><br /><span style="color:rgb(0,153,0);font-family:courier new;font-size:78%;" class="rem">/* </span><span style="color:rgb(0,153,0);font-family:courier new;font-size:78%;" class="rem">Check that sum of each given element, across all pin rows, adds to 100%. */</span><span style="font-size:78%;"><br /><br /></span><span style="color:rgb(0,153,0);font-family:courier new;font-size:78%;" class="rem">/* 2 arrays to hold all elements and sum of their percentages. */</span><span style="font-size:78%;"><br /><span style="font-family:courier new;">&amp;arrElements = CreateArray();</span><br /><span style="font-family:courier new;">&amp;arrPercent = CreateArray();</span><br /><br /></span><span style="color:rgb(0,153,0);font-family:courier new;font-size:78%;" class="rem">/* Populate the arrays. */</span><span style="font-size:78%;"><br /><span style="font-family:courier new;">Local Rowset &amp;rsGP_GL_DIST_DTL = GetRowset(Scroll.GP_GL_DIST_DTL);</span><br /><span style="font-family:courier new;">For &amp;i = 1 To &amp;rsGP_GL_DIST_DTL.ActiveRowCount</span><br /><span style="font-family:courier new;">   Local Rowset &amp;rsGP_GL_DIST_PIN = &amp;rsGP_GL_DIST_DTL(&amp;i).GetRowset(Scroll.GP_GL_DIST_PIN);</span><br /><span style="font-family:courier new;">   </span><br /><span style="font-family:courier new;">   </span></span><span style="color:rgb(0,153,0);font-family:courier new;font-size:78%;" class="rem">/* Check there are actually any element rows (if one does they all do, vice-versa). Populate arrays if found.*/</span><span style="font-size:78%;"><br /><span style="font-family:courier new;">   If &amp;rsGP_GL_DIST_PIN(1).GP_GL_DIST_PIN.PIN_NUM.Value = 0 Then</span><br /><span style="font-family:courier new;">      &amp;hasElements = False;<br /></span></span><span><span><span style="font-size:78%;"><span style="font-family:courier new;">      Break;</span></span></span></span><br /><span style="font-size:78%;"><span style="font-family:courier new;">   Else</span><br /><span style="font-family:courier new;">      &amp;hasElements = True;</span><br /><span style="font-family:courier new;">      For &amp;j = 1 To &amp;rsGP_GL_DIST_PIN.ActiveRowCount</span><br /><span style="font-family:courier new;">         &amp;element = &amp;rsGP_GL_DIST_PIN(&amp;j).GP_PIN_DESCR_VW.DESCR.Value;</span><br /><span style="font-family:courier new;">         &amp;percent = &amp;rsGP_GL_DIST_PIN(&amp;j).GP_GL_DIST_PIN.PCT_TO_ALLOCATE.Value;</span><br /><span style="font-family:courier new;">         &amp;found = &amp;arrElements.Find(&amp;element);</span><br /><span style="font-family:courier new;">         If &amp;found = 0 Then</span><br /><span style="font-family:courier new;">            &amp;arrElements.Push(&amp;element);</span><br /><span style="font-family:courier new;">            &amp;arrPercent.Push(&amp;percent);</span><br /><span style="font-family:courier new;">         Else</span><br /><span style="font-family:courier new;">            &amp;arrPercent [&amp;found] = &amp;arrPercent [&amp;found] + &amp;percent;</span><br /><span style="font-family:courier new;">         End-If;</span><br /><span style="font-family:courier new;">      End-For;</span><br /><span style="font-family:courier new;">   End-If;</span><br /><span style="font-family:courier new;">   </span><br /><span style="font-family:courier new;">End-For;</span><br /><br /></span><span style="color:rgb(0,153,0);font-family:courier new;font-size:78%;" class="rem">/* Check for any elements that are  100% and advise with warning msg &amp; highlighting the field. */</span><span style="font-size:78%;"><br /><span style="font-family:courier new;">If &amp;hasElements Then</span><br /><span style="font-family:courier new;">   For &amp;k = 1 To &amp;arrPercent.Len</span><br /><span style="font-family:courier new;">      </span><br /><span style="font-family:courier new;">      &amp;err = False;</span><br /><span style="font-family:courier new;">      If &amp;arrPercent [&amp;k]  100 Then</span><br /><span style="font-family:courier new;">         &amp;err = True;</span><br /><span style="font-family:courier new;">      End-If;</span><br /><span style="font-family:courier new;">      </span><br /><span style="font-family:courier new;">      For &amp;i = 1 To &amp;rsGP_GL_DIST_DTL.ActiveRowCount</span><br /><span style="font-family:courier new;">         &amp;rsGP_GL_DIST_PIN = &amp;rsGP_GL_DIST_DTL(&amp;i).GetRowset(Scroll.GP_GL_DIST_PIN);</span><br /><span style="font-family:courier new;">         For &amp;j = 1 To &amp;rsGP_GL_DIST_PIN.ActiveRowCount</span><br /><span style="font-family:courier new;">            If &amp;rsGP_GL_DIST_PIN(&amp;j).GP_PIN_DESCR_VW.DESCR.Value = &amp;arrElements [&amp;k] Then</span><br /><span style="font-family:courier new;">               If &amp;err Then</span><br /><span style="font-family:courier new;">                  &amp;rsGP_GL_DIST_PIN(&amp;j).GP_GL_DIST_PIN.PCT_TO_ALLOCATE.SetCursorPos(%Page);</span><br /><span style="font-family:courier new;">                  &amp;rsGP_GL_DIST_PIN(&amp;j).GP_GL_DIST_PIN.PCT_TO_ALLOCATE.Style = </span></span><span style="font-family:courier new;font-size:78%;" class="str">"PSERROR"</span><span style="font-size:78%;"><span style="font-family:courier new;">;</span><br /><span style="font-family:courier new;">                  Error </span></span><span style="font-family:courier new;font-size:78%;" class="str">"Sum percentages of Element '"</span><span style="font-size:78%;"><span style="font-family:courier new;"> | &amp;arrElements [&amp;k] | </span></span><span style="font-family:courier new;font-size:78%;" class="str">"' do not total 100%."</span><span style="font-size:78%;"><span style="font-family:courier new;">;</span><br /><span style="font-family:courier new;">               Else</span><br /><span style="font-family:courier new;">                  &amp;rsGP_GL_DIST_PIN(&amp;j).GP_GL_DIST_PIN.PCT_TO_ALLOCATE.Style = </span></span><span style="font-family:courier new;font-size:78%;" class="str">"PSEDITBOX"</span><span style="font-size:78%;"><span style="font-family:courier new;">;</span><br /><span style="font-family:courier new;">               End-If;</span><br /><span style="font-family:courier new;">            End-If;</span><br /><span style="font-family:courier new;">         End-For;</span><br /><span style="font-family:courier new;">      End-For;</span><br /><span style="font-family:courier new;">      </span><br /><span style="font-family:courier new;">   End-For;</span><br /><span style="font-family:courier new;">End-If;</span></span><br /></pre>
