---
layout: post
title: Component Field Find & Replace
date: 2014-12-04 03:58:00.000000000 +11:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories: []
tags: []
meta:
  blogger_blog: capital-it.blogspot.com
  blogger_author: Michael Nitschke
  blogger_0c9a3d51488c214aefd1a54a659341d6_permalink: '2489617673925107167'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p>Sometimes you just want to find a field and replace its value no matter where it is in the Component.
<pre style="font-family:Andale Mono, Lucida Console, Monaco, fixed, monospace;color:#000000;background-color:#eee;font-size:12px;border:1px dashed #999999;line-height:14px;padding:5px;overflow:auto;width:100%;"><code>class General;<br />   <br />   method ComponentFieldFindReplace(&amp;rs As Rowset, &amp;fieldName As string, &amp;find As string, &amp;replace As string)<br />end-class;<br /><br /><br /><br />/* Searches *entire* Component Buffer for a given Field Name, and optional value, <br />   and replaces with the given value. <br /><br />   &amp;rs:        The RowSet that the search will begin at, and cascade down from. Generally use GetLevel0().<br />   &amp;fieldName: The name of the Field whose value you want to replace.<br />   &amp;find:      (optional) The value to match<br />   &amp;replace:   The value to update the Field.Value with.<br /><br />   Example: &amp;clsGPUtilities.ComponentFieldFindReplace(GetLevel0(), "YOUR_FIELD", "", "X");<br />*/<br />method ComponentFieldFindReplace<br />   /+ &amp;rs as Rowset, +/<br />   /+ &amp;fieldName as String, +/<br />   /+ &amp;find as String, +/<br />   /+ &amp;replace as String +/<br />   <br />   Local integer &amp;i, &amp;r, &amp;f, &amp;c;<br />   <br />   For &amp;i = 1 To &amp;rs.RowCount<br />      <br />      For &amp;r = 1 To &amp;rs(&amp;i).RecordCount<br />         For &amp;f = 1 To &amp;rs(&amp;i).GetRecord(&amp;r).FieldCount<br />            If &amp;rs(&amp;i).GetRecord(&amp;r).GetField(&amp;f).Name = &amp;fieldName Then<br />               If &amp;find = "" Or<br />                     &amp;find = &amp;rs(&amp;i).GetRecord(&amp;r).GetField(&amp;f).Value Then<br />                  &amp;rs(&amp;i).GetRecord(&amp;r).GetField(&amp;f).Value = &amp;replace;<br />               End-If;<br />            End-If;<br />         End-For;<br />      End-For;<br />      <br />      /* Do same for each child RowSet of this Row. */<br />      For &amp;c = 1 To &amp;rs(&amp;i).ChildCount<br />         %This.ComponentFieldFindReplace(&amp;rs(&amp;i).GetRowset(&amp;c), &amp;fieldName, &amp;find, &amp;replace);<br />      End-For;<br />      <br />   End-For;<br />   <br />end-method;<br /></code></pre>
