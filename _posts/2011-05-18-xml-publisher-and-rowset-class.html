---
layout: post
title: XML Publisher and Rowset Class
date: 2011-05-18 06:40:00.000000000 +10:00
type: post
parent_id: '0'
published: true
password: ''
status: publish
categories:
- XML Publisher App Package Class
tags: []
meta:
  blogger_blog: capital-it.blogspot.com
  blogger_author: Michael Nitschke
  blogger_0c9a3d51488c214aefd1a54a659341d6_permalink: '8542616711679798712'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p>Example Class for an Application Package. Takes a Rowset and passes to the given Publisher Report and Template.</p>
<pre style="font-family:Andale Mono, Lucida Console, Monaco, fixed, monospace;color:#000000;background-color:#eee;font-size:12px;border:1px dashed #999999;line-height:14px;padding:5px;overflow:auto;width:100%;"><code>/********************************************************************************<br />SAMS_BRD220X Michael Nitschke 12/05/2011 XML Publisher<br />Common Class for XML Publisher<br /><br />Users can use the method CreateXMLFilesFromRS to create only XML and XSD file,<br />very useful for XMLPublisher Template creation.<br /><br />The PublishXMLReportFromRS method will create the XML Files and publish the given <br />report.<br />********************************************************************************/<br />import PSXP_XMLGEN:*;<br />import PSXP_RPTDEFNMANAGER:*;<br /><br />class XMLPublisher<br />   method XMLPublisher();<br />   method PublishXMLReportFromRS();<br />   method CreateXMLFilesFromRS();<br />   <br />   property Rowset rsData;<br />   property string sFileNameXSD;<br />   property string sFileNameXML;<br />   property string sRptDefn;<br />   property string sReportTemplate;<br />   property number processInstance;<br />   property string xmlFileName;<br />end-class;<br /><br />method XMLPublisher<br />   /* Constructor. */<br />end-method;<br /><br /><br />/* Takes the rsData rowset property and uses it to publish a report, using other property values. */<br />method PublishXMLReportFromRS<br />   <br />   %This.CreateXMLFilesFromRS();<br />   <br />   /* Generate the report. */<br />   Local any &amp;oRptDefn = create PSXP_RPTDEFNMANAGER:ReportDefn(&amp;sRptDefn); /* report definition name */<br />   &amp;oRptDefn.Get();<br />   &amp;oRptDefn.SetRuntimeDataXMLFile(%This.xmlFileName); /* Connect report and data. */<br />   &amp;oRptDefn.ProcessReport(&amp;sReportTemplate, %Language_User, %Date, ""); /* report's template ID */<br />   &amp;oRptDefn.OutDestination = %FilePath;<br />   <br />   /* Publish to Report Manager. */<br />   &amp;oRptDefn.Publish("", "", "", &amp;processInstance);<br />   <br />end-method;<br /><br />method CreateXMLFilesFromRS<br />   <br />   /* Create XSD file. */<br />   Local PSXP_XMLGEN:RowSetDS &amp;oXML_GENERATOR = create psxp_xmlgen:RowSetDS();<br />   Local string &amp;my_schema = &amp;oXML_GENERATOR.getXSDSchema(&amp;rsData);<br />   Local File &amp;XSD_File = GetFile(&amp;sFileNameXSD, "W");<br />   &amp;XSD_File.WriteLine(&amp;my_schema);<br />   &amp;XSD_File.Close();<br />   <br />   /* Create XML file. */<br />   Local string &amp;my_xml = &amp;oXML_GENERATOR.getXMLData(&amp;rsData, "");<br />   Local File &amp;XML_File = GetFile(&amp;sFileNameXML, "W");<br />   &amp;XML_File.WriteLine(&amp;my_xml);<br />   %This.xmlFileName = &amp;XML_File.Name;<br />   &amp;XML_File.Close();<br />   <br />end-method;<br /><br /></code></pre>
