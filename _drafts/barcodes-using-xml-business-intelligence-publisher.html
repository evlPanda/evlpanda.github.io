---
layout: post
title: Barcodes using XML/Business Intelligence Publisher
date: 
type: post
parent_id: '0'
published: false
password: ''
status: draft
categories:
- Barcode XML Publisher
tags: []
meta:
  blogger_blog: capital-it.blogspot.com
  blogger_author: Michael Nitschke
  blogger_0c9a3d51488c214aefd1a54a659341d6_permalink: '5791031538862528225'
author:
  login: evlpanda
  email: m.nitschke@gmail.com
  display_name: Michael Nitschke
  first_name: ''
  last_name: ''
---
<p><!--[if gte mso 9]&gt;     Normal   0               false   false   false      EN-AU   X-NONE   X-NONE                                                     MicrosoftInternetExplorer4                                                   &lt;![endif]--><!--[if gte mso 9]&gt;                                                                                                                                                                                                                                                                                                                                                                                                                                &lt;![endif]--> <!--  /* Font Definitions */  @font-face 	{font-family:"Cambria Math"; 	panose-1:2 4 5 3 5 4 6 3 2 4; 	mso-font-alt:"Arial Unicode MS"; 	mso-font-charset:0; 	mso-generic-font-family:roman; 	mso-font-pitch:variable; 	mso-font-signature:-1610611985 1107304683 0 0 159 0;} @font-face 	{font-family:Calibri; 	panose-1:2 15 5 2 2 2 4 3 2 4; 	mso-font-alt:"Arial Rounded MT Bold"; 	mso-font-charset:0; 	mso-generic-font-family:swiss; 	mso-font-pitch:variable; 	mso-font-signature:-1610611985 1073750139 0 0 159 0;}  /* Style Definitions */  p.MsoNormal, li.MsoNormal, div.MsoNormal 	{mso-style-unhide:no; 	mso-style-qformat:yes; 	mso-style-parent:""; 	margin:0cm; 	margin-bottom:.0001pt; 	mso-pagination:widow-orphan; 	font-size:11.0pt; 	font-family:"Calibri","sans-serif"; 	mso-fareast-font-family:Calibri; 	mso-fareast-theme-font:minor-latin; 	mso-bidi-font-family:"Times New Roman";} a:link, span.MsoHyperlink 	{mso-style-priority:99; 	color:blue; 	text-decoration:underline; 	text-underline:single;} a:visited, span.MsoHyperlinkFollowed 	{mso-style-noshow:yes; 	mso-style-priority:99; 	color:purple; 	mso-themecolor:followedhyperlink; 	text-decoration:underline; 	text-underline:single;} p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph 	{mso-style-priority:34; 	mso-style-unhide:no; 	mso-style-qformat:yes; 	margin-top:0cm; 	margin-right:0cm; 	margin-bottom:0cm; 	margin-left:36.0pt; 	margin-bottom:.0001pt; 	mso-pagination:widow-orphan; 	font-size:11.0pt; 	font-family:"Calibri","sans-serif"; 	mso-fareast-font-family:Calibri; 	mso-fareast-theme-font:minor-latin; 	mso-bidi-font-family:"Times New Roman";} .MsoChpDefault 	{mso-style-type:export-only; 	mso-default-props:yes; 	font-size:10.0pt; 	mso-ansi-font-size:10.0pt; 	mso-bidi-font-size:10.0pt;} @page Section1 	{size:612.0pt 792.0pt; 	margin:72.0pt 72.0pt 72.0pt 72.0pt; 	mso-header-margin:36.0pt; 	mso-footer-margin:36.0pt; 	mso-paper-source:0;} div.Section1 	{page:Section1;}  /* List Definitions */  @list l0 	{mso-list-id:299966779; 	mso-list-type:hybrid; 	mso-list-template-ids:258745794 67698689 67698691 67698689 67698689 67698691 67698693 67698689 67698691 67698693;} @list l0:level1 	{mso-level-number-format:bullet; 	mso-level-text:; 	mso-level-tab-stop:36.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt; 	font-family:Symbol;} @list l0:level2 	{mso-level-number-format:bullet; 	mso-level-text:o; 	mso-level-tab-stop:72.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt; 	font-family:"Courier New";} @list l0:level3 	{mso-level-number-format:bullet; 	mso-level-text:; 	mso-level-tab-stop:108.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt; 	font-family:Symbol;} @list l0:level4 	{mso-level-tab-stop:144.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l0:level5 	{mso-level-tab-stop:180.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l0:level6 	{mso-level-tab-stop:216.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l0:level7 	{mso-level-tab-stop:252.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l0:level8 	{mso-level-tab-stop:288.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l0:level9 	{mso-level-tab-stop:324.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l1 	{mso-list-id:900020734; 	mso-list-type:hybrid; 	mso-list-template-ids:-350177344 201916431 201916441 201916443 201916431 201916441 201916443 201916431 201916441 201916443;} @list l1:level1 	{mso-level-tab-stop:none; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l1:level2 	{mso-level-tab-stop:72.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l1:level3 	{mso-level-tab-stop:108.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l1:level4 	{mso-level-tab-stop:144.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l1:level5 	{mso-level-tab-stop:180.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l1:level6 	{mso-level-tab-stop:216.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l1:level7 	{mso-level-tab-stop:252.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l1:level8 	{mso-level-tab-stop:288.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l1:level9 	{mso-level-tab-stop:324.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l2 	{mso-list-id:1157916600; 	mso-list-type:hybrid; 	mso-list-template-ids:-112814094 201916431 201916419 201916443 201916431 201916441 201916443 201916431 201916441 201916443;} @list l2:level1 	{mso-level-tab-stop:36.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l2:level2 	{mso-level-number-format:bullet; 	mso-level-text:o; 	mso-level-tab-stop:72.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt; 	font-family:"Courier New";} @list l2:level3 	{mso-level-tab-stop:108.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l2:level4 	{mso-level-tab-stop:144.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l2:level5 	{mso-level-tab-stop:180.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l2:level6 	{mso-level-tab-stop:216.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l2:level7 	{mso-level-tab-stop:252.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l2:level8 	{mso-level-tab-stop:288.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} @list l2:level9 	{mso-level-tab-stop:324.0pt; 	mso-level-number-position:left; 	text-indent:-18.0pt;} ol 	{margin-bottom:0cm;} ul 	{margin-bottom:0cm;} --> <!--[if gte mso 10]&gt;   /* Style Definitions */  table.MsoNormalTable 	{mso-style-name:"Table Normal"; 	mso-tstyle-rowband-size:0; 	mso-tstyle-colband-size:0; 	mso-style-noshow:yes; 	mso-style-priority:99; 	mso-style-qformat:yes; 	mso-style-parent:""; 	mso-padding-alt:0cm 5.4pt 0cm 5.4pt; 	mso-para-margin:0cm; 	mso-para-margin-bottom:.0001pt; 	mso-pagination:widow-orphan; 	font-size:10.0pt; 	font-family:"Times New Roman","serif";}  &lt;![endif]-->
<p class="MsoNormal"><a name="_Ref225842383">PRE-REQUISITES FOR USING CODE 128 FONT IN XMLP</a></p>
<p class="MsoNormal">
<p class="MsoListParagraph" style="text-indent:-18pt;"><!--[if !supportLists]--><font><font>1.<font size="7">       </font></font></font><!--[endif]-->Before barcodes could be used in XMLP templates, a Code128 barcode font needed to be installed.</p>
<p class="MsoListParagraph">For that purpose, the Code 128 barcode font was downloaded from the following site:</p>
<p class="MsoListParagraph">
<p class="MsoListParagraph"><a href="http://grandzebu.net/index.php?page=/informatique/codbar-en/code128.htm">http://grandzebu.net/index.php?page=/informatique/codbar-en/code128.htm</a></p>
<p class="MsoListParagraph">
<p class="MsoListParagraph">For use within XML publisher templates, the font was installed on the developer's local C:\Windows\fonts directory</p>
<p class="MsoNormal" style="margin-left:36pt;">
<ol style="margin-top:0;" start="2" type="1">
<li class="MsoNormal"><font>If not already      installed, the barcode font (code128.ttf) will also need to be installed      in the following directory on the App Server:</font></li>
<ul style="margin-top:0;" type="circle">
<li class="MsoNormal"><font>/fonts/truetype</font></li>
</ul>
</ol>
<p class="MsoNormal" style="margin-left:72pt;">
<ol style="margin-top:0;" start="3" type="1">
<li class="MsoNormal" style="page-break-after:avoid;"><font>If      not already created, the XMLP config file needs to be created in the      following directory,  in order to make use of the new barcode font:</font></li>
</ol>
<ul style="margin-top:0;" type="disc">
<ul style="margin-top:0;" type="circle">
<li class="MsoNormal" style="page-break-after:avoid;"><font>/jre/lib/xdo.cfg on the  app server</font></li>
<li class="MsoNormal" style="page-break-after:avoid;"><font>/jre/lib/xdo.cfg on the process scheduler server</font></li>
</ul>
</ul>
<p class="MsoNormal" style="margin-left:36pt;">
<p class="MsoNormal" style="margin-left:36pt;page-break-after:avoid;">The XMLP config file should contain the following:</p>
<p class="MsoNormal" style="margin-left:36pt;page-break-after:avoid;">
<p class="MsoNormal" style="margin-left:36pt;"><font size="9">&lt;config version=&quot;1.0.0&quot; xmlns=&quot;<a>http://xmlns.oracle.com/oxp/config/"&gt;</a></font></p>
<p class="MsoNormal" style="margin-left:36pt;"><font size="9">   <!-- Font setting --></font></p>
<p class="MsoNormal" style="margin-left:36pt;"><font size="9">   </font></p>
<p class="MsoNormal" style="margin-left:36pt;"><font size="9">      <font></font></font></p>
<p class="MsoNormal" style="margin-left:36pt;"><font size="9">         &lt;truetype path=&quot;<span><font></font>/code128.ttf " /&gt;</span></font></p>
<p class="MsoNormal" style="margin-left:36pt;"><font size="9">      </font></p>
<p class="MsoNormal" style="margin-left:36pt;"><font size="9">   </font></p>
<p class="MsoNormal" style="margin-left:36pt;"><font size="9"></font></p>
<p class="MsoNormal"><font style="color:rgb(31,73,125);"> </font></p>
<p class="MsoNormal">GENERATING THE BARCODE</p>
<p class="MsoNormal">
<p class="MsoListParagraph" style="text-indent:-18pt;"><!--[if !supportLists]--><font><font>1.<font size="7">       </font></font></font><!--[endif]-->Put the barcode field in the XMLP template (e.g. )</p>
<p class="MsoListParagraph" style="text-indent:-18pt;"><!--[if !supportLists]--><font><font>2.<font size="7">       </font></font></font><!--[endif]-->Set the barcode field (i.e. BARCODE) before passing it to the template. This is done via the <b>getCode128BarCode </b>function. The function is provided here:</p>
<p class="MsoListParagraph">
<p class="MsoNormal"><font>/**</font></p>
<p class="MsoNormal"><font> * getCode128BarCode</font></p>
<p class="MsoNormal"><font> * </font></p>
<p class="MsoNormal"><font> * This function generates Code128 barcode for the given string. It uses subsets B and C when generating barcode </font></p>
<p class="MsoNormal"><font> * string (not subset A). </font></p>
<p class="MsoNormal"><font> * @param In &amp;strDataToFormat - string to format into the barcode.</font></p>
<p class="MsoNormal"><font> * Returns: ASCII characters needed to represent the barcode.</font></p>
<p class="MsoNormal"><font> *</font></p>
<p class="MsoNormal"><font> * ASSUMPTIONS: The &amp;strDataToFormat string does not contain any invalid characters. Only ASCII characters 32 to 126 are</font></p>
<p class="MsoNormal"><font> * allowed - if there are invalid characters, an empty string is returned. The function itself appends the necessary special </font></p>
<p class="MsoNormal"><font> * ASCII characters to generate the barcode.</font></p>
<p class="MsoNormal"><font> *</font></p>
<p class="MsoNormal"><font> * The algorithm for creating barcodes is based upon the sample code provided on this site, with slight modifications:</font></p>
<p class="MsoNormal"><font> * <a href="http://grandzebu.net/index.php?page=/informatique/codbar-en/code128.htm">http://grandzebu.net/index.php?page=/informatique/codbar-en/code128.htm</a></font></p>
<p class="MsoNormal"><font>**/</font></p>
<p class="MsoNormal"><font>Function getCode128BarCode(&amp;strDataToFormat As string) Returns string</font></p>
<p class="MsoNormal"><font>   </font></p>
<p class="MsoNormal"><font>   Local boolean &amp;boolSubsetB = True;</font></p>
<p class="MsoNormal"><font>   Local boolean &amp;boolIsDigits;</font></p>
<p class="MsoNormal"><font>   Local string &amp;strBarcode = "";</font></p>
<p class="MsoNormal"><font>   Local integer &amp;i;</font></p>
<p class="MsoNormal"><font>   Local integer &amp;intCharNum, &amp;charsToCheck, &amp;intCheckSum;</font></p>
<p class="MsoNormal"><font>   </font></p>
<p class="MsoNormal"><font>   /* No need to process an empty string - simply return what was put in */</font></p>
<p class="MsoNormal"><font>   If Len(&amp;strDataToFormat) = 0 Then</font></p>
<p class="MsoNormal"><font>      Return &amp;strBarcode;</font></p>
<p class="MsoNormal"><font>   End-If;</font></p>
<p class="MsoNormal"><font>   </font></p>
<p class="MsoNormal"><font>   /* Check for valid characters */</font></p>
<p class="MsoNormal"><font>   For &amp;i = 1 To Len(&amp;strDataToFormat)</font></p>
<p class="MsoNormal"><font>      &amp;intCharNum = Code(Substring(&amp;strDataToFormat, &amp;i, 1));</font></p>
<p class="MsoNormal"><font>      If &amp;intCharNum &gt;= 32 And</font></p>
<p class="MsoNormal"><font>            &amp;intCharNum &lt;= 126 Then</font></p>
<p class="MsoNormal"><font>      Else</font></p>
<p class="MsoNormal"><font>         /* invalid characters found - return empty string */</font></p>
<p class="MsoNormal"><font>         Return "";</font></p>
<p class="MsoNormal"><font>      End-If;</font></p>
<p class="MsoNormal"><font>   End-For;</font></p>
<p class="MsoNormal"><font>   </font></p>
<p class="MsoNormal"><font>   &amp;i = 1;</font></p>
<p class="MsoNormal"><font>   </font></p>
<p class="MsoNormal"><font>   While &amp;i &lt;= Len(&amp;strDataToFormat)</font></p>
<p class="MsoNormal"><font>      </font></p>
<p class="MsoNormal"><font>      If &amp;boolSubsetB Then</font></p>
<p class="MsoNormal"><font>         /* see if it's worth it to switch to subset C */</font></p>
<p class="MsoNormal"><font>         /* yes for 4 digits at start or end, else if 6 digits */</font></p>
<p class="MsoNormal"><font>         If (&amp;i = 1) Or</font></p>
<p class="MsoNormal"><font>               (&amp;i + 3) = Len(&amp;strDataToFormat) Then</font></p>
<p class="MsoNormal"><font>            &amp;charsToCheck = 4;</font></p>
<p class="MsoNormal"><font>         Else</font></p>
<p class="MsoNormal"><font>            &amp;charsToCheck = 6;</font></p>
<p class="MsoNormal"><font>         End-If;</font></p>
<p class="MsoNormal"><font>         </font></p>
<p class="MsoNormal"><font>         &amp;boolIsDigits = False;</font></p>
<p class="MsoNormal"><font>         If IsDigits(Substring(&amp;strDataToFormat, &amp;i, &amp;charsToCheck)) And</font></p>
<p class="MsoNormal"><font>               (Len(Substring(&amp;strDataToFormat, &amp;i, &amp;charsToCheck)) = &amp;charsToCheck) Then</font></p>
<p class="MsoNormal"><font>            &amp;boolIsDigits = True;</font></p>
<p class="MsoNormal"><font>         End-If;</font></p>
<p class="MsoNormal"><font>         </font></p>
<p class="MsoNormal"><font>         If &amp;boolIsDigits Then</font></p>
<p class="MsoNormal"><font>            </font></p>
<p class="MsoNormal"><font>            If &amp;i = 1 Then</font></p>
<p class="MsoNormal"><font>               /* Put Start C character, to indicate barcode starts with subset C */</font></p>
<p class="MsoNormal"><font>               &amp;strBarcode = Char(210);</font></p>
<p class="MsoNormal"><font>            Else</font></p>
<p class="MsoNormal"><font>               /* Put Code C character, to indicate switch to subset C */</font></p>
<p class="MsoNormal"><font>               &amp;strBarcode = &amp;strBarcode | Char(204);</font></p>
<p class="MsoNormal"><font>            End-If;</font></p>
<p class="MsoNormal"><font>            &amp;boolSubsetB = False;</font></p>
<p class="MsoNormal"><font>            </font></p>
<p class="MsoNormal"><font>         Else</font></p>
<p class="MsoNormal"><font>            </font></p>
<p class="MsoNormal"><font>            If &amp;i = 1 Then</font></p>
<p class="MsoNormal"><font>               /* Put Start B character, to indicate barcode starts with subset B */</font></p>
<p class="MsoNormal"><font>               &amp;strBarcode = Char(209);</font></p>
<p class="MsoNormal"><font>            End-If;</font></p>
<p class="MsoNormal"><font>            </font></p>
<p class="MsoNormal"><font>         End-If;</font></p>
<p class="MsoNormal"><font>         </font></p>
<p class="MsoNormal"><font>      End-If;</font></p>
<p class="MsoNormal"><font>      </font></p>
<p class="MsoNormal"><font>      If Not &amp;boolSubsetB Then</font></p>
<p class="MsoNormal"><font>         </font></p>
<p class="MsoNormal"><font>         /* We are on subset C, try to process 2 digits */</font></p>
<p class="MsoNormal"><font>         &amp;boolIsDigits = False;</font></p>
<p class="MsoNormal"><font>         </font></p>
<p class="MsoNormal"><font>         If IsDigits(Substring(&amp;strDataToFormat, &amp;i, 2)) And</font></p>
<p class="MsoNormal"><font>               (Len(Substring(&amp;strDataToFormat, &amp;i, 2)) = 2) Then</font></p>
<p class="MsoNormal"><font>            &amp;boolIsDigits = True;</font></p>
<p class="MsoNormal"><font>         End-If;</font></p>
<p class="MsoNormal"><font>         </font></p>
<p class="MsoNormal"><font>         If &amp;boolIsDigits Then</font></p>
<p class="MsoNormal"><font>            /* 2 digits - process using subset C */</font></p>
<p class="MsoNormal"><font>            &amp;intCharNum = Value(Substring(&amp;strDataToFormat, &amp;i, 2));</font></p>
<p class="MsoNormal"><font>            If &amp;intCharNum = 0 Then</font></p>
<p class="MsoNormal"><font>               &amp;intCharNum = 212;</font></p>
<p class="MsoNormal"><font>            Else</font></p>
<p class="MsoNormal"><font>               If &amp;intCharNum </font></p>
<p class="MsoNormal"><font>                  &amp;intCharNum = &amp;intCharNum + 32;</font></p>
<p class="MsoNormal"><font>               Else</font></p>
<p class="MsoNormal"><font>                  &amp;intCharNum = &amp;intCharNum + 105;</font></p>
<p class="MsoNormal"><font>               End-If;</font></p>
<p class="MsoNormal"><font>            End-If;</font></p>
<p class="MsoNormal"><font>            </font></p>
<p class="MsoNormal"><font>            &amp;strBarcode = &amp;strBarcode | Char(&amp;intCharNum);</font></p>
<p class="MsoNormal"><font>            &amp;i = &amp;i + 2;</font></p>
<p class="MsoNormal"><font>            </font></p>
<p class="MsoNormal"><font>         Else</font></p>
<p class="MsoNormal"><font>            /* revert back to subset B */</font></p>
<p class="MsoNormal"><font>            &amp;strBarcode = &amp;strBarcode | Char(205);</font></p>
<p class="MsoNormal"><font>            &amp;boolSubsetB = True;</font></p>
<p class="MsoNormal"><font>            </font></p>
<p class="MsoNormal"><font>         End-If;</font></p>
<p class="MsoNormal"><font>         </font></p>
<p class="MsoNormal"><font>      End-If;</font></p>
<p class="MsoNormal"><font>      </font></p>
<p class="MsoNormal"><font>      If &amp;boolSubsetB Then</font></p>
<p class="MsoNormal"><font>         </font></p>
<p class="MsoNormal"><font>         /* Process 1 digit with subset B */</font></p>
<p class="MsoNormal"><font>         &amp;strBarcode = &amp;strBarcode | Substring(&amp;strDataToFormat, &amp;i, 1);</font></p>
<p class="MsoNormal"><font>         &amp;i = &amp;i + 1</font></p>
<p class="MsoNormal"><font>      End-If;</font></p>
<p class="MsoNormal"><font>      </font></p>
<p class="MsoNormal"><font>   End-While;</font></p>
<p class="MsoNormal"><font>   </font></p>
<p class="MsoNormal"><font>   /* Calculation of the checksum */</font></p>
<p class="MsoNormal"><font>   For &amp;i = 1 To Len(&amp;strBarcode)</font></p>
<p class="MsoNormal"><font>      </font></p>
<p class="MsoNormal"><font>      &amp;intCharNum = Code(Substring(&amp;strBarcode, &amp;i, 1));</font></p>
<p class="MsoNormal"><font>      If &amp;intCharNum = 212 Then</font></p>
<p class="MsoNormal"><font>         &amp;intCharNum = 0;</font></p>
<p class="MsoNormal"><font>      Else</font></p>
<p class="MsoNormal"><font>         If &amp;intCharNum </font></p>
<p class="MsoNormal"><font>            &amp;intCharNum = &amp;intCharNum - 32;</font></p>
<p class="MsoNormal"><font>         Else</font></p>
<p class="MsoNormal"><font>            &amp;intCharNum = &amp;intCharNum - 105;</font></p>
<p class="MsoNormal"><font>         End-If;</font></p>
<p class="MsoNormal"><font>      End-If;</font></p>
<p class="MsoNormal"><font>      </font></p>
<p class="MsoNormal"><font>      If &amp;i = 1 Then</font></p>
<p class="MsoNormal"><font>         &amp;intCheckSum = &amp;intCharNum;</font></p>
<p class="MsoNormal"><font>      Else</font></p>
<p class="MsoNormal"><font>         &amp;intCheckSum = &amp;intCheckSum + (&amp;intCharNum * (&amp;i - 1));</font></p>
<p class="MsoNormal"><font>      End-If;</font></p>
<p class="MsoNormal"><font>      </font></p>
<p class="MsoNormal"><font>   End-For;</font></p>
<p class="MsoNormal"><font>   </font></p>
<p class="MsoNormal"><font>   /* Apply modulo 103 to the weighted total to get the checksum */</font></p>
<p class="MsoNormal"><font>   &amp;intCheckSum = Mod(&amp;intCheckSum, 103);</font></p>
<p class="MsoNormal"><font>   </font></p>
<p class="MsoNormal"><font>   /* Calculate checksum ASCII code */</font></p>
<p class="MsoNormal"><font>   If &amp;intCheckSum </font></p>
<p class="MsoNormal"><font>      &amp;intCheckSum = &amp;intCheckSum + 32;</font></p>
<p class="MsoNormal"><font>   Else</font></p>
<p class="MsoNormal"><font>      &amp;intCheckSum = &amp;intCheckSum + 105;</font></p>
<p class="MsoNormal"><font>   End-If;</font></p>
<p class="MsoNormal"><font>   </font></p>
<p class="MsoNormal"><font>   /* Add the checksum and the STOP */</font></p>
<p class="MsoNormal"><font>   &amp;strBarcode = &amp;strBarcode | Char(&amp;intCheckSum) | Char(211);</font></p>
<p class="MsoNormal"><font>   </font></p>
<p class="MsoNormal"><font>   Return &amp;strBarcode;</font></p>
<p class="MsoNormal"><font>   </font></p>
<p class="MsoNormal"><font>End-Function;</font><font style="color:rgb(31,73,125);"></font></p>
