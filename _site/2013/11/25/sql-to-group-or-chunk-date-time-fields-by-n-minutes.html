<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>SQL to Group or Chunk Date Time Fields by n Minutes | The PeopleSoft Experience</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="SQL to Group or Chunk Date Time Fields by n Minutes" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Say you want to chunk some statistics data into 10 minute intervals. as of Oracle 11g you can use the extract() function that will pull out hours, minutes and the like from a DateTime column. select to_date(trunc(dttm_stamp) || &#39; &#39; || extract(hour from dttm_stamp) || &#39;:&#39; || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;), &#39;dd-mon-yy hh24:mi&#39;) as dttm_stamp, count(some_field) &quot;count&quot;from ps_statistics_tablegroup by trunc(dttm_stamp) || &#39; &#39; || extract(hour from dttm_stamp) || &#39;:&#39; || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;); Note the +0.1 bit that handles the range of results, up to that point spanning from 0 to 6. We can&#39;t have nn:60 as a vaild DateTime. This is also why we have the -10 part. Also note that depending on the platform that is actually executing the SQL you may have to fiddle around with the DateTime formats. &#39;dd-mon-yy hh24:mi&#39; might not cut it for you. PeopleSoft will require &#39;yyyy-mm-dd hh24:mi&#39; for example. A breakdown of the entire line: select dttm_stamp as a, extract(minute from dttm_stamp) as b, ceil(extract(minute from dttm_stamp)/10 + 0.1) as c, ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10 as d, lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;) as e, trunc(dttm_stamp) || &#39; &#39; || extract(hour from dttm_stamp) || &#39;:&#39; || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;) as dttm_stampfrom ps_statistics_table; The final results from the first query: 17/11/2013 10:00:00 AM 9917/11/2013 10:10:00 AM 12017/11/2013 10:20:00 AM 5017/11/2013 10:30:00 AM 1017/11/2013 10:40:00 AM 6517/11/2013 10:50:00 AM 7717/11/2013 11:00:00 AM 18917/11/2013 11:10:00 AM 20117/11/2013 11:20:00 AM 23517/11/2013 11:30:00 AM 18817/11/2013 11:40:00 AM 10517/11/2013 11:50:00 AM 77" />
<meta property="og:description" content="Say you want to chunk some statistics data into 10 minute intervals. as of Oracle 11g you can use the extract() function that will pull out hours, minutes and the like from a DateTime column. select to_date(trunc(dttm_stamp) || &#39; &#39; || extract(hour from dttm_stamp) || &#39;:&#39; || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;), &#39;dd-mon-yy hh24:mi&#39;) as dttm_stamp, count(some_field) &quot;count&quot;from ps_statistics_tablegroup by trunc(dttm_stamp) || &#39; &#39; || extract(hour from dttm_stamp) || &#39;:&#39; || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;); Note the +0.1 bit that handles the range of results, up to that point spanning from 0 to 6. We can&#39;t have nn:60 as a vaild DateTime. This is also why we have the -10 part. Also note that depending on the platform that is actually executing the SQL you may have to fiddle around with the DateTime formats. &#39;dd-mon-yy hh24:mi&#39; might not cut it for you. PeopleSoft will require &#39;yyyy-mm-dd hh24:mi&#39; for example. A breakdown of the entire line: select dttm_stamp as a, extract(minute from dttm_stamp) as b, ceil(extract(minute from dttm_stamp)/10 + 0.1) as c, ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10 as d, lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;) as e, trunc(dttm_stamp) || &#39; &#39; || extract(hour from dttm_stamp) || &#39;:&#39; || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;) as dttm_stampfrom ps_statistics_table; The final results from the first query: 17/11/2013 10:00:00 AM 9917/11/2013 10:10:00 AM 12017/11/2013 10:20:00 AM 5017/11/2013 10:30:00 AM 1017/11/2013 10:40:00 AM 6517/11/2013 10:50:00 AM 7717/11/2013 11:00:00 AM 18917/11/2013 11:10:00 AM 20117/11/2013 11:20:00 AM 23517/11/2013 11:30:00 AM 18817/11/2013 11:40:00 AM 10517/11/2013 11:50:00 AM 77" />
<link rel="canonical" href="http://localhost:4000/2013/11/25/sql-to-group-or-chunk-date-time-fields-by-n-minutes.html" />
<meta property="og:url" content="http://localhost:4000/2013/11/25/sql-to-group-or-chunk-date-time-fields-by-n-minutes.html" />
<meta property="og:site_name" content="The PeopleSoft Experience" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2013-11-25T23:48:00+11:00" />
<script type="application/ld+json">
{"description":"Say you want to chunk some statistics data into 10 minute intervals. as of Oracle 11g you can use the extract() function that will pull out hours, minutes and the like from a DateTime column. select to_date(trunc(dttm_stamp) || &#39; &#39; || extract(hour from dttm_stamp) || &#39;:&#39; || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;), &#39;dd-mon-yy hh24:mi&#39;) as dttm_stamp, count(some_field) &quot;count&quot;from ps_statistics_tablegroup by trunc(dttm_stamp) || &#39; &#39; || extract(hour from dttm_stamp) || &#39;:&#39; || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;); Note the +0.1 bit that handles the range of results, up to that point spanning from 0 to 6. We can&#39;t have nn:60 as a vaild DateTime. This is also why we have the -10 part. Also note that depending on the platform that is actually executing the SQL you may have to fiddle around with the DateTime formats. &#39;dd-mon-yy hh24:mi&#39; might not cut it for you. PeopleSoft will require &#39;yyyy-mm-dd hh24:mi&#39; for example. A breakdown of the entire line: select dttm_stamp as a, extract(minute from dttm_stamp) as b, ceil(extract(minute from dttm_stamp)/10 + 0.1) as c, ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10 as d, lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;) as e, trunc(dttm_stamp) || &#39; &#39; || extract(hour from dttm_stamp) || &#39;:&#39; || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, &#39;0&#39;) as dttm_stampfrom ps_statistics_table; The final results from the first query: 17/11/2013 10:00:00 AM 9917/11/2013 10:10:00 AM 12017/11/2013 10:20:00 AM 5017/11/2013 10:30:00 AM 1017/11/2013 10:40:00 AM 6517/11/2013 10:50:00 AM 7717/11/2013 11:00:00 AM 18917/11/2013 11:10:00 AM 20117/11/2013 11:20:00 AM 23517/11/2013 11:30:00 AM 18817/11/2013 11:40:00 AM 10517/11/2013 11:50:00 AM 77","@type":"BlogPosting","url":"http://localhost:4000/2013/11/25/sql-to-group-or-chunk-date-time-fields-by-n-minutes.html","headline":"SQL to Group or Chunk Date Time Fields by n Minutes","dateModified":"2013-11-25T23:48:00+11:00","datePublished":"2013-11-25T23:48:00+11:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2013/11/25/sql-to-group-or-chunk-date-time-fields-by-n-minutes.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="The PeopleSoft Experience" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">The PeopleSoft Experience</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">SQL to Group or Chunk Date Time Fields by n Minutes</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2013-11-25T23:48:00+11:00" itemprop="datePublished">Nov 25, 2013
      </time>â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{"login"=>"evlpanda", "email"=>"m.nitschke@gmail.com", "display_name"=>"Michael Nitschke", "first_name"=>"", "last_name"=>""}</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Say you want to chunk some statistics data into 10 minute intervals. as of Oracle 11g you can use the <i>extract()</i> function that will pull out hours, minutes and the like from a DateTime column.
<pre style="background-color:#eeeeee;border:1px dashed #999999;color:black;font-family:Andale Mono, Lucida Console, Monaco, fixed, monospace;font-size:12px;line-height:14px;overflow:auto;padding:5px;width:100%;"><code>select<br />  to_date(trunc(dttm_stamp) || ' ' || extract(hour from dttm_stamp) || ':' || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, '0'), 'dd-mon-yy hh24:mi') as dttm_stamp<br />, count(some_field) "count"<br />from <br />  ps_statistics_table<br />group by<br />  trunc(dttm_stamp) || ' ' || extract(hour from dttm_stamp) || ':' || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, '0')<br />;<br /></code></pre>
<p>Note the +0.1 bit that handles the range of results, up to that point spanning from 0 to 6. We can't have <i>nn</i>:60 as a vaild DateTime. This is also why we have the -10 part.</p>
<p>Also note that depending on the platform that is actually executing the SQL you may have to fiddle around with the DateTime formats. 'dd-mon-yy hh24:mi' might not cut it for you. PeopleSoft will require 'yyyy-mm-dd hh24:mi' for example.</p>
<p>A breakdown of the entire line:
<pre style="background-color:#eeeeee;border:1px dashed #999999;color:black;font-family:Andale Mono, Lucida Console, Monaco, fixed, monospace;font-size:12px;line-height:14px;overflow:auto;padding:5px;width:100%;"><code>select<br />  dttm_stamp as a<br />, extract(minute from dttm_stamp) as b<br />, ceil(extract(minute from dttm_stamp)/10 + 0.1)  as c<br />, ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10 as d<br />, lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, '0') as e<br />, trunc(dttm_stamp) || ' ' || extract(hour from dttm_stamp) || ':' || lpad(ceil(extract(minute from dttm_stamp)/10 + 0.1) * 10 - 10, 2, '0') as dttm_stamp<br />from ps_statistics_table<br />;<br /></code></pre>
<p>The final results from the first query:  
<pre style="background-color:#eeeeee;border:1px dashed #999999;color:black;font-family:Andale Mono, Lucida Console, Monaco, fixed, monospace;font-size:12px;line-height:14px;overflow:auto;padding:5px;width:100%;"><code>17/11/2013 10:00:00 AM 99<br />17/11/2013 10:10:00 AM 120<br />17/11/2013 10:20:00 AM 50<br />17/11/2013 10:30:00 AM 10<br />17/11/2013 10:40:00 AM 65<br />17/11/2013 10:50:00 AM 77<br />17/11/2013 11:00:00 AM 189<br />17/11/2013 11:10:00 AM 201<br />17/11/2013 11:20:00 AM 235<br />17/11/2013 11:30:00 AM 188<br />17/11/2013 11:40:00 AM 105<br />17/11/2013 11:50:00 AM 77<br /><br /></code></pre>

  </div><a class="u-url" href="/2013/11/25/sql-to-group-or-chunk-date-time-fields-by-n-minutes.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">The PeopleSoft Experience</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">The PeopleSoft Experience</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/evlPanda"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">evlPanda</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Musings, chit-chat, and sometimes useful stuff related to PeopleSoft, especially PeopleCode.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
