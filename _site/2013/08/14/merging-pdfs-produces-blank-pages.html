<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Merging PDFs Produces Blank Pages | The PeopleSoft Experience</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="Merging PDFs Produces Blank Pages" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="So you&#39;re creating a number of individual PDFs, doing something with them, and then you want to merge them all into one, nice, long PDF at the end. Something like this: /* Merge! */Local boolean &amp;booMergeSuccess = &amp;objMergeTool.mergePDFs(&amp;arrFiles, &amp;sNSMergedFileDestination | &amp;sDirSep | &quot;merged.pdf&quot;, &amp;sError); You can see this in Communication Generation for example. But when you open the PDF only the first page has data, the rest are blank. What&#39;s going on? I finally reduced this down to being something &quot;wrong&quot; with the individual PDFs that were being created, before they were merged. It wasn&#39;t the templates. It was something specific to the PDF files themselves. Comparing them to an environment where (luckily) the merge did work showed that the PDFs that did merge had no security, while the ones that didn&#39;t merge did have security. File &gt; Properties &gt; Security. xdo.cfg was the same in both environments. So where was this coming from? I noticed that, in 8.53 at least, there are some new parameters for BI Publisher Report Definitions, namely PDF Security. The default for pdf-security was True. I changed this to False and the merge worked. Finally. This is overriding the global value at the report level. The global value is set at:Reporting Tools &gt; BI Publisher &gt; Setup &gt; Global Properties tl;dr solution: update PSXPGLBPROPset propvalue = &#39;False&#39;where proplname = &#39;pdf-security&#39;;" />
<meta property="og:description" content="So you&#39;re creating a number of individual PDFs, doing something with them, and then you want to merge them all into one, nice, long PDF at the end. Something like this: /* Merge! */Local boolean &amp;booMergeSuccess = &amp;objMergeTool.mergePDFs(&amp;arrFiles, &amp;sNSMergedFileDestination | &amp;sDirSep | &quot;merged.pdf&quot;, &amp;sError); You can see this in Communication Generation for example. But when you open the PDF only the first page has data, the rest are blank. What&#39;s going on? I finally reduced this down to being something &quot;wrong&quot; with the individual PDFs that were being created, before they were merged. It wasn&#39;t the templates. It was something specific to the PDF files themselves. Comparing them to an environment where (luckily) the merge did work showed that the PDFs that did merge had no security, while the ones that didn&#39;t merge did have security. File &gt; Properties &gt; Security. xdo.cfg was the same in both environments. So where was this coming from? I noticed that, in 8.53 at least, there are some new parameters for BI Publisher Report Definitions, namely PDF Security. The default for pdf-security was True. I changed this to False and the merge worked. Finally. This is overriding the global value at the report level. The global value is set at:Reporting Tools &gt; BI Publisher &gt; Setup &gt; Global Properties tl;dr solution: update PSXPGLBPROPset propvalue = &#39;False&#39;where proplname = &#39;pdf-security&#39;;" />
<link rel="canonical" href="http://localhost:4000/2013/08/14/merging-pdfs-produces-blank-pages.html" />
<meta property="og:url" content="http://localhost:4000/2013/08/14/merging-pdfs-produces-blank-pages.html" />
<meta property="og:site_name" content="The PeopleSoft Experience" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2013-08-14T05:45:00+10:00" />
<script type="application/ld+json">
{"description":"So you&#39;re creating a number of individual PDFs, doing something with them, and then you want to merge them all into one, nice, long PDF at the end. Something like this: /* Merge! */Local boolean &amp;booMergeSuccess = &amp;objMergeTool.mergePDFs(&amp;arrFiles, &amp;sNSMergedFileDestination | &amp;sDirSep | &quot;merged.pdf&quot;, &amp;sError); You can see this in Communication Generation for example. But when you open the PDF only the first page has data, the rest are blank. What&#39;s going on? I finally reduced this down to being something &quot;wrong&quot; with the individual PDFs that were being created, before they were merged. It wasn&#39;t the templates. It was something specific to the PDF files themselves. Comparing them to an environment where (luckily) the merge did work showed that the PDFs that did merge had no security, while the ones that didn&#39;t merge did have security. File &gt; Properties &gt; Security. xdo.cfg was the same in both environments. So where was this coming from? I noticed that, in 8.53 at least, there are some new parameters for BI Publisher Report Definitions, namely PDF Security. The default for pdf-security was True. I changed this to False and the merge worked. Finally. This is overriding the global value at the report level. The global value is set at:Reporting Tools &gt; BI Publisher &gt; Setup &gt; Global Properties tl;dr solution: update PSXPGLBPROPset propvalue = &#39;False&#39;where proplname = &#39;pdf-security&#39;;","@type":"BlogPosting","url":"http://localhost:4000/2013/08/14/merging-pdfs-produces-blank-pages.html","headline":"Merging PDFs Produces Blank Pages","dateModified":"2013-08-14T05:45:00+10:00","datePublished":"2013-08-14T05:45:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2013/08/14/merging-pdfs-produces-blank-pages.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="The PeopleSoft Experience" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">The PeopleSoft Experience</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Merging PDFs Produces Blank Pages</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2013-08-14T05:45:00+10:00" itemprop="datePublished">Aug 14, 2013
      </time>â€¢ <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{"login"=>"evlpanda", "email"=>"m.nitschke@gmail.com", "display_name"=>"Michael Nitschke", "first_name"=>"", "last_name"=>""}</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>So you're creating a number of individual PDFs, doing something with them, and then you want to merge them all into one, nice, long PDF at the end.</p>
<p>Something like this:<br /> 
<pre style="font-family:Andale Mono, Lucida Console, Monaco, fixed, monospace;color:#000000;background-color:#eee;font-size:12px;border:1px dashed #999999;line-height:14px;padding:5px;overflow:auto;width:100%;"><code>/* Merge! */<br />Local boolean &amp;booMergeSuccess = &amp;objMergeTool.mergePDFs(&amp;arrFiles, &amp;sNSMergedFileDestination | &amp;sDirSep | "merged.pdf", &amp;sError);<br /></code></pre>
<p>You can see this in Communication Generation for example.</p>
<p>But when you open the PDF only the first page has data, the rest are blank. What's going on?</p>
<p>I <i>finally</i> reduced this down to being something "wrong" with the individual PDFs that were being created, before they were merged. It wasn't the templates. It was something specific to the PDF files themselves.</p>
<p>Comparing them to an environment where (luckily) the merge did work showed that the PDFs that did merge had no security, while the ones that didn't merge did have security. <i>File &gt; Properties &gt; Security</i>.</p>
<p><i>xdo.cfg</i> was the same in both environments. So where was this coming from?</p>
<p>I noticed that, in 8.53 at least, there are some new parameters for BI Publisher Report Definitions, namely <i>PDF Security</i>. The default for <i>pdf-security</i> was T<i>rue.</i></p>
<p>I changed this to <i>False</i> and the merge worked. Finally.</p>
<p>This is overriding the global value at the report level. The global value is set at:<br /><i>Reporting Tools &gt; BI Publisher &gt; Setup &gt; Global Properties </i>
<div dir="ltr" id="imcontent"><span dir="ltr" style="color:black;direction:ltr;font-family:'Segoe UI';font-size:10pt;word-wrap:break-word;"></span></div>
<p><b>tl;dr solution:</b></p>
<p><tt>update PSXPGLBPROP</tt><br /><tt>set propvalue = 'False'</tt><br /><tt>where proplname = 'pdf-security';</tt></p>
<p></p>

  </div><a class="u-url" href="/2013/08/14/merging-pdfs-produces-blank-pages.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">The PeopleSoft Experience</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">The PeopleSoft Experience</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/evlPanda"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">evlPanda</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Musings, chit-chat, and sometimes useful stuff related to PeopleSoft, especially PeopleCode.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
