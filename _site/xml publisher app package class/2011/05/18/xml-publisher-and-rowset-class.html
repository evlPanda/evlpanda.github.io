<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>XML Publisher and Rowset Class | The PeopleSoft Experience</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="XML Publisher and Rowset Class" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Example Class for an Application Package. Takes a Rowset and passes to the given Publisher Report and Template. /********************************************************************************SAMS_BRD220X Michael Nitschke 12/05/2011 XML PublisherCommon Class for XML PublisherUsers can use the method CreateXMLFilesFromRS to create only XML and XSD file,very useful for XMLPublisher Template creation.The PublishXMLReportFromRS method will create the XML Files and publish the given report.********************************************************************************/import PSXP_XMLGEN:*;import PSXP_RPTDEFNMANAGER:*;class XMLPublisher method XMLPublisher(); method PublishXMLReportFromRS(); method CreateXMLFilesFromRS(); property Rowset rsData; property string sFileNameXSD; property string sFileNameXML; property string sRptDefn; property string sReportTemplate; property number processInstance; property string xmlFileName;end-class;method XMLPublisher /* Constructor. */end-method;/* Takes the rsData rowset property and uses it to publish a report, using other property values. */method PublishXMLReportFromRS %This.CreateXMLFilesFromRS(); /* Generate the report. */ Local any &amp;oRptDefn = create PSXP_RPTDEFNMANAGER:ReportDefn(&amp;sRptDefn); /* report definition name */ &amp;oRptDefn.Get(); &amp;oRptDefn.SetRuntimeDataXMLFile(%This.xmlFileName); /* Connect report and data. */ &amp;oRptDefn.ProcessReport(&amp;sReportTemplate, %Language_User, %Date, &quot;&quot;); /* report&#39;s template ID */ &amp;oRptDefn.OutDestination = %FilePath; /* Publish to Report Manager. */ &amp;oRptDefn.Publish(&quot;&quot;, &quot;&quot;, &quot;&quot;, &amp;processInstance); end-method;method CreateXMLFilesFromRS /* Create XSD file. */ Local PSXP_XMLGEN:RowSetDS &amp;oXML_GENERATOR = create psxp_xmlgen:RowSetDS(); Local string &amp;my_schema = &amp;oXML_GENERATOR.getXSDSchema(&amp;rsData); Local File &amp;XSD_File = GetFile(&amp;sFileNameXSD, &quot;W&quot;); &amp;XSD_File.WriteLine(&amp;my_schema); &amp;XSD_File.Close(); /* Create XML file. */ Local string &amp;my_xml = &amp;oXML_GENERATOR.getXMLData(&amp;rsData, &quot;&quot;); Local File &amp;XML_File = GetFile(&amp;sFileNameXML, &quot;W&quot;); &amp;XML_File.WriteLine(&amp;my_xml); %This.xmlFileName = &amp;XML_File.Name; &amp;XML_File.Close(); end-method;" />
<meta property="og:description" content="Example Class for an Application Package. Takes a Rowset and passes to the given Publisher Report and Template. /********************************************************************************SAMS_BRD220X Michael Nitschke 12/05/2011 XML PublisherCommon Class for XML PublisherUsers can use the method CreateXMLFilesFromRS to create only XML and XSD file,very useful for XMLPublisher Template creation.The PublishXMLReportFromRS method will create the XML Files and publish the given report.********************************************************************************/import PSXP_XMLGEN:*;import PSXP_RPTDEFNMANAGER:*;class XMLPublisher method XMLPublisher(); method PublishXMLReportFromRS(); method CreateXMLFilesFromRS(); property Rowset rsData; property string sFileNameXSD; property string sFileNameXML; property string sRptDefn; property string sReportTemplate; property number processInstance; property string xmlFileName;end-class;method XMLPublisher /* Constructor. */end-method;/* Takes the rsData rowset property and uses it to publish a report, using other property values. */method PublishXMLReportFromRS %This.CreateXMLFilesFromRS(); /* Generate the report. */ Local any &amp;oRptDefn = create PSXP_RPTDEFNMANAGER:ReportDefn(&amp;sRptDefn); /* report definition name */ &amp;oRptDefn.Get(); &amp;oRptDefn.SetRuntimeDataXMLFile(%This.xmlFileName); /* Connect report and data. */ &amp;oRptDefn.ProcessReport(&amp;sReportTemplate, %Language_User, %Date, &quot;&quot;); /* report&#39;s template ID */ &amp;oRptDefn.OutDestination = %FilePath; /* Publish to Report Manager. */ &amp;oRptDefn.Publish(&quot;&quot;, &quot;&quot;, &quot;&quot;, &amp;processInstance); end-method;method CreateXMLFilesFromRS /* Create XSD file. */ Local PSXP_XMLGEN:RowSetDS &amp;oXML_GENERATOR = create psxp_xmlgen:RowSetDS(); Local string &amp;my_schema = &amp;oXML_GENERATOR.getXSDSchema(&amp;rsData); Local File &amp;XSD_File = GetFile(&amp;sFileNameXSD, &quot;W&quot;); &amp;XSD_File.WriteLine(&amp;my_schema); &amp;XSD_File.Close(); /* Create XML file. */ Local string &amp;my_xml = &amp;oXML_GENERATOR.getXMLData(&amp;rsData, &quot;&quot;); Local File &amp;XML_File = GetFile(&amp;sFileNameXML, &quot;W&quot;); &amp;XML_File.WriteLine(&amp;my_xml); %This.xmlFileName = &amp;XML_File.Name; &amp;XML_File.Close(); end-method;" />
<link rel="canonical" href="http://localhost:4000/xml%20publisher%20app%20package%20class/2011/05/18/xml-publisher-and-rowset-class.html" />
<meta property="og:url" content="http://localhost:4000/xml%20publisher%20app%20package%20class/2011/05/18/xml-publisher-and-rowset-class.html" />
<meta property="og:site_name" content="The PeopleSoft Experience" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2011-05-18T06:40:00+10:00" />
<script type="application/ld+json">
{"description":"Example Class for an Application Package. Takes a Rowset and passes to the given Publisher Report and Template. /********************************************************************************SAMS_BRD220X Michael Nitschke 12/05/2011 XML PublisherCommon Class for XML PublisherUsers can use the method CreateXMLFilesFromRS to create only XML and XSD file,very useful for XMLPublisher Template creation.The PublishXMLReportFromRS method will create the XML Files and publish the given report.********************************************************************************/import PSXP_XMLGEN:*;import PSXP_RPTDEFNMANAGER:*;class XMLPublisher method XMLPublisher(); method PublishXMLReportFromRS(); method CreateXMLFilesFromRS(); property Rowset rsData; property string sFileNameXSD; property string sFileNameXML; property string sRptDefn; property string sReportTemplate; property number processInstance; property string xmlFileName;end-class;method XMLPublisher /* Constructor. */end-method;/* Takes the rsData rowset property and uses it to publish a report, using other property values. */method PublishXMLReportFromRS %This.CreateXMLFilesFromRS(); /* Generate the report. */ Local any &amp;oRptDefn = create PSXP_RPTDEFNMANAGER:ReportDefn(&amp;sRptDefn); /* report definition name */ &amp;oRptDefn.Get(); &amp;oRptDefn.SetRuntimeDataXMLFile(%This.xmlFileName); /* Connect report and data. */ &amp;oRptDefn.ProcessReport(&amp;sReportTemplate, %Language_User, %Date, &quot;&quot;); /* report&#39;s template ID */ &amp;oRptDefn.OutDestination = %FilePath; /* Publish to Report Manager. */ &amp;oRptDefn.Publish(&quot;&quot;, &quot;&quot;, &quot;&quot;, &amp;processInstance); end-method;method CreateXMLFilesFromRS /* Create XSD file. */ Local PSXP_XMLGEN:RowSetDS &amp;oXML_GENERATOR = create psxp_xmlgen:RowSetDS(); Local string &amp;my_schema = &amp;oXML_GENERATOR.getXSDSchema(&amp;rsData); Local File &amp;XSD_File = GetFile(&amp;sFileNameXSD, &quot;W&quot;); &amp;XSD_File.WriteLine(&amp;my_schema); &amp;XSD_File.Close(); /* Create XML file. */ Local string &amp;my_xml = &amp;oXML_GENERATOR.getXMLData(&amp;rsData, &quot;&quot;); Local File &amp;XML_File = GetFile(&amp;sFileNameXML, &quot;W&quot;); &amp;XML_File.WriteLine(&amp;my_xml); %This.xmlFileName = &amp;XML_File.Name; &amp;XML_File.Close(); end-method;","@type":"BlogPosting","url":"http://localhost:4000/xml%20publisher%20app%20package%20class/2011/05/18/xml-publisher-and-rowset-class.html","headline":"XML Publisher and Rowset Class","dateModified":"2011-05-18T06:40:00+10:00","datePublished":"2011-05-18T06:40:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/xml%20publisher%20app%20package%20class/2011/05/18/xml-publisher-and-rowset-class.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="The PeopleSoft Experience" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">The PeopleSoft Experience</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">XML Publisher and Rowset Class</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2011-05-18T06:40:00+10:00" itemprop="datePublished">May 18, 2011
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{"login"=>"evlpanda", "email"=>"m.nitschke@gmail.com", "display_name"=>"Michael Nitschke", "first_name"=>"", "last_name"=>""}</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>Example Class for an Application Package. Takes a Rowset and passes to the given Publisher Report and Template.</p>
<pre style="font-family:Andale Mono, Lucida Console, Monaco, fixed, monospace;color:#000000;background-color:#eee;font-size:12px;border:1px dashed #999999;line-height:14px;padding:5px;overflow:auto;width:100%;"><code>/********************************************************************************<br />SAMS_BRD220X Michael Nitschke 12/05/2011 XML Publisher<br />Common Class for XML Publisher<br /><br />Users can use the method CreateXMLFilesFromRS to create only XML and XSD file,<br />very useful for XMLPublisher Template creation.<br /><br />The PublishXMLReportFromRS method will create the XML Files and publish the given <br />report.<br />********************************************************************************/<br />import PSXP_XMLGEN:*;<br />import PSXP_RPTDEFNMANAGER:*;<br /><br />class XMLPublisher<br />   method XMLPublisher();<br />   method PublishXMLReportFromRS();<br />   method CreateXMLFilesFromRS();<br />   <br />   property Rowset rsData;<br />   property string sFileNameXSD;<br />   property string sFileNameXML;<br />   property string sRptDefn;<br />   property string sReportTemplate;<br />   property number processInstance;<br />   property string xmlFileName;<br />end-class;<br /><br />method XMLPublisher<br />   /* Constructor. */<br />end-method;<br /><br /><br />/* Takes the rsData rowset property and uses it to publish a report, using other property values. */<br />method PublishXMLReportFromRS<br />   <br />   %This.CreateXMLFilesFromRS();<br />   <br />   /* Generate the report. */<br />   Local any &amp;oRptDefn = create PSXP_RPTDEFNMANAGER:ReportDefn(&amp;sRptDefn); /* report definition name */<br />   &amp;oRptDefn.Get();<br />   &amp;oRptDefn.SetRuntimeDataXMLFile(%This.xmlFileName); /* Connect report and data. */<br />   &amp;oRptDefn.ProcessReport(&amp;sReportTemplate, %Language_User, %Date, ""); /* report's template ID */<br />   &amp;oRptDefn.OutDestination = %FilePath;<br />   <br />   /* Publish to Report Manager. */<br />   &amp;oRptDefn.Publish("", "", "", &amp;processInstance);<br />   <br />end-method;<br /><br />method CreateXMLFilesFromRS<br />   <br />   /* Create XSD file. */<br />   Local PSXP_XMLGEN:RowSetDS &amp;oXML_GENERATOR = create psxp_xmlgen:RowSetDS();<br />   Local string &amp;my_schema = &amp;oXML_GENERATOR.getXSDSchema(&amp;rsData);<br />   Local File &amp;XSD_File = GetFile(&amp;sFileNameXSD, "W");<br />   &amp;XSD_File.WriteLine(&amp;my_schema);<br />   &amp;XSD_File.Close();<br />   <br />   /* Create XML file. */<br />   Local string &amp;my_xml = &amp;oXML_GENERATOR.getXMLData(&amp;rsData, "");<br />   Local File &amp;XML_File = GetFile(&amp;sFileNameXML, "W");<br />   &amp;XML_File.WriteLine(&amp;my_xml);<br />   %This.xmlFileName = &amp;XML_File.Name;<br />   &amp;XML_File.Close();<br />   <br />end-method;<br /><br /></code></pre>

  </div><a class="u-url" href="/xml%20publisher%20app%20package%20class/2011/05/18/xml-publisher-and-rowset-class.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">The PeopleSoft Experience</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">The PeopleSoft Experience</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/evlPanda"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">evlPanda</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Musings, chit-chat, and sometimes useful stuff related to PeopleSoft, especially PeopleCode.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
