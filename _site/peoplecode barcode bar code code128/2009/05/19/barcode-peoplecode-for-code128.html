<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Barcode PeopleCode for code128 | The PeopleSoft Experience</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="Barcode PeopleCode for code128" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="/* This class provides methods to : * Assist in development of XML/IB Publisher documents. */class XML_Publisher method XML_Publisher(); method getCode128BarCode(&amp;strDataToFormat As string) Returns string;end-class; /* Method :- Config_Data * Constructor * Arguments :- None. * Returns :- None. */method XML_Publisherend-method; /* USQSF023, Michael Nitschke 06.05.2009 * Method :- GetFieldValues * Arguments :- &amp;strDataToFormat = string to format to code128 format.. * Returns :- Formatted string. *//** * getCode128BarCode * * This function generates Code128 barcode for the given string. It uses subsets B and C when generating barcode * string (not subset A). * @param In &amp;strDataToFormat - string to format into the barcode. * Returns: ASCII characters needed to represent the barcode. * * ASSUMPTIONS: The &amp;strDataToFormat string does not contain any invalid characters. Only ASCII characters 32 to 126 are * allowed - if there are invalid characters, an empty string is returned. The function itself appends the necessary special * ASCII characters to generate the barcode. * * The algorithm for creating barcodes is based upon the sample code provided on this site, with slight modifications: * http://grandzebu.net/index.php?page=/informatique/codbar-en/code128.htm**/method getCode128BarCode /+ &amp;strDataToFormat as String +/ /+ Returns String +/ Local boolean &amp;boolSubsetB = True; Local boolean &amp;boolIsDigits; Local string &amp;strBarcode = &quot;&quot;; Local integer &amp;i; Local integer &amp;intCharNum, &amp;charsToCheck, &amp;intCheckSum; /* While developing... */ rem &amp;strDataToFormat = &quot;123456789012345678901234567890&quot;; /* No need to process an empty string - simply return what was put in */ If Len(&amp;strDataToFormat) = 0 Then Return &amp;strBarcode; End-If; /* Check for valid characters */ For &amp;i = 1 To Len(&amp;strDataToFormat) &amp;intCharNum = Code(Substring(&amp;strDataToFormat, &amp;i, 1)); If &amp;intCharNum &gt;= 32 And &amp;intCharNum &lt;= 126 Then Else /* invalid characters found - return empty string */ Return &quot;&quot;; End-If; End-For; &amp;i = 1; While &amp;i &lt;= Len(&amp;strDataToFormat) If &amp;boolSubsetB Then /* see if it&#39;s worth it to switch to subset C */ /* yes for 4 digits at start or end, else if 6 digits */ If (&amp;i = 1) Or (&amp;i + 3) = Len(&amp;strDataToFormat) Then &amp;charsToCheck = 4; Else &amp;charsToCheck = 6; End-If; &amp;boolIsDigits = False; If IsDigits(Substring(&amp;strDataToFormat, &amp;i, &amp;charsToCheck)) And (Len(Substring(&amp;strDataToFormat, &amp;i, &amp;charsToCheck)) = &amp;charsToCheck) Then &amp;boolIsDigits = True; End-If; If &amp;boolIsDigits Then If &amp;i = 1 Then /* Put Start C character, to indicate barcode starts with subset C */ &amp;strBarcode = Char(210); Else /* Put Code C character, to indicate switch to subset C */ &amp;strBarcode = &amp;strBarcode | Char(204); End-If; &amp;boolSubsetB = False; Else If &amp;i = 1 Then /* Put Start B character, to indicate barcode starts with subset B */ &amp;strBarcode = Char(209); End-If; End-If; End-If; If Not &amp;boolSubsetB Then /* We are on subset C, try to process 2 digits */ &amp;boolIsDigits = False; If IsDigits(Substring(&amp;strDataToFormat, &amp;i, 2)) And (Len(Substring(&amp;strDataToFormat, &amp;i, 2)) = 2) Then &amp;boolIsDigits = True; End-If; If &amp;boolIsDigits Then /* 2 digits - process using subset C */ &amp;intCharNum = Value(Substring(&amp;strDataToFormat, &amp;i, 2)); If &amp;intCharNum = 0 Then &amp;intCharNum = 212; Else If &amp;intCharNum &lt; 95 Then &amp;intCharNum = &amp;intCharNum + 32; Else &amp;intCharNum = &amp;intCharNum + 105; End-If; End-If; &amp;strBarcode = &amp;strBarcode | Char(&amp;intCharNum); &amp;i = &amp;i + 2; Else /* revert back to subset B */ &amp;strBarcode = &amp;strBarcode | Char(205); &amp;boolSubsetB = True; End-If; End-If; If &amp;boolSubsetB Then /* Process 1 digit with subset B */ &amp;strBarcode = &amp;strBarcode | Substring(&amp;strDataToFormat, &amp;i, 1); &amp;i = &amp;i + 1 End-If; End-While; /* Calculation of the checksum */ For &amp;i = 1 To Len(&amp;strBarcode) &amp;intCharNum = Code(Substring(&amp;strBarcode, &amp;i, 1)); If &amp;intCharNum = 212 Then &amp;intCharNum = 0; Else If &amp;intCharNum &lt; 127 Then &amp;intCharNum = &amp;intCharNum - 32; Else &amp;intCharNum = &amp;intCharNum - 105; End-If; End-If; If &amp;i = 1 Then &amp;intCheckSum = &amp;intCharNum; Else &amp;intCheckSum = &amp;intCheckSum + (&amp;intCharNum * (&amp;i - 1)); End-If; End-For; /* Apply modulo 103 to the weighted total to get the checksum */ &amp;intCheckSum = Mod(&amp;intCheckSum, 103); /* Calculate checksum ASCII code */ If &amp;intCheckSum &lt; 95 Then &amp;intCheckSum = &amp;intCheckSum + 32; Else &amp;intCheckSum = &amp;intCheckSum + 105; End-If; /* Add the checksum and the STOP */ &amp;strBarcode = &amp;strBarcode | Char(&amp;intCheckSum) | Char(211); Return &amp;strBarcode; end-method;" />
<meta property="og:description" content="/* This class provides methods to : * Assist in development of XML/IB Publisher documents. */class XML_Publisher method XML_Publisher(); method getCode128BarCode(&amp;strDataToFormat As string) Returns string;end-class; /* Method :- Config_Data * Constructor * Arguments :- None. * Returns :- None. */method XML_Publisherend-method; /* USQSF023, Michael Nitschke 06.05.2009 * Method :- GetFieldValues * Arguments :- &amp;strDataToFormat = string to format to code128 format.. * Returns :- Formatted string. *//** * getCode128BarCode * * This function generates Code128 barcode for the given string. It uses subsets B and C when generating barcode * string (not subset A). * @param In &amp;strDataToFormat - string to format into the barcode. * Returns: ASCII characters needed to represent the barcode. * * ASSUMPTIONS: The &amp;strDataToFormat string does not contain any invalid characters. Only ASCII characters 32 to 126 are * allowed - if there are invalid characters, an empty string is returned. The function itself appends the necessary special * ASCII characters to generate the barcode. * * The algorithm for creating barcodes is based upon the sample code provided on this site, with slight modifications: * http://grandzebu.net/index.php?page=/informatique/codbar-en/code128.htm**/method getCode128BarCode /+ &amp;strDataToFormat as String +/ /+ Returns String +/ Local boolean &amp;boolSubsetB = True; Local boolean &amp;boolIsDigits; Local string &amp;strBarcode = &quot;&quot;; Local integer &amp;i; Local integer &amp;intCharNum, &amp;charsToCheck, &amp;intCheckSum; /* While developing... */ rem &amp;strDataToFormat = &quot;123456789012345678901234567890&quot;; /* No need to process an empty string - simply return what was put in */ If Len(&amp;strDataToFormat) = 0 Then Return &amp;strBarcode; End-If; /* Check for valid characters */ For &amp;i = 1 To Len(&amp;strDataToFormat) &amp;intCharNum = Code(Substring(&amp;strDataToFormat, &amp;i, 1)); If &amp;intCharNum &gt;= 32 And &amp;intCharNum &lt;= 126 Then Else /* invalid characters found - return empty string */ Return &quot;&quot;; End-If; End-For; &amp;i = 1; While &amp;i &lt;= Len(&amp;strDataToFormat) If &amp;boolSubsetB Then /* see if it&#39;s worth it to switch to subset C */ /* yes for 4 digits at start or end, else if 6 digits */ If (&amp;i = 1) Or (&amp;i + 3) = Len(&amp;strDataToFormat) Then &amp;charsToCheck = 4; Else &amp;charsToCheck = 6; End-If; &amp;boolIsDigits = False; If IsDigits(Substring(&amp;strDataToFormat, &amp;i, &amp;charsToCheck)) And (Len(Substring(&amp;strDataToFormat, &amp;i, &amp;charsToCheck)) = &amp;charsToCheck) Then &amp;boolIsDigits = True; End-If; If &amp;boolIsDigits Then If &amp;i = 1 Then /* Put Start C character, to indicate barcode starts with subset C */ &amp;strBarcode = Char(210); Else /* Put Code C character, to indicate switch to subset C */ &amp;strBarcode = &amp;strBarcode | Char(204); End-If; &amp;boolSubsetB = False; Else If &amp;i = 1 Then /* Put Start B character, to indicate barcode starts with subset B */ &amp;strBarcode = Char(209); End-If; End-If; End-If; If Not &amp;boolSubsetB Then /* We are on subset C, try to process 2 digits */ &amp;boolIsDigits = False; If IsDigits(Substring(&amp;strDataToFormat, &amp;i, 2)) And (Len(Substring(&amp;strDataToFormat, &amp;i, 2)) = 2) Then &amp;boolIsDigits = True; End-If; If &amp;boolIsDigits Then /* 2 digits - process using subset C */ &amp;intCharNum = Value(Substring(&amp;strDataToFormat, &amp;i, 2)); If &amp;intCharNum = 0 Then &amp;intCharNum = 212; Else If &amp;intCharNum &lt; 95 Then &amp;intCharNum = &amp;intCharNum + 32; Else &amp;intCharNum = &amp;intCharNum + 105; End-If; End-If; &amp;strBarcode = &amp;strBarcode | Char(&amp;intCharNum); &amp;i = &amp;i + 2; Else /* revert back to subset B */ &amp;strBarcode = &amp;strBarcode | Char(205); &amp;boolSubsetB = True; End-If; End-If; If &amp;boolSubsetB Then /* Process 1 digit with subset B */ &amp;strBarcode = &amp;strBarcode | Substring(&amp;strDataToFormat, &amp;i, 1); &amp;i = &amp;i + 1 End-If; End-While; /* Calculation of the checksum */ For &amp;i = 1 To Len(&amp;strBarcode) &amp;intCharNum = Code(Substring(&amp;strBarcode, &amp;i, 1)); If &amp;intCharNum = 212 Then &amp;intCharNum = 0; Else If &amp;intCharNum &lt; 127 Then &amp;intCharNum = &amp;intCharNum - 32; Else &amp;intCharNum = &amp;intCharNum - 105; End-If; End-If; If &amp;i = 1 Then &amp;intCheckSum = &amp;intCharNum; Else &amp;intCheckSum = &amp;intCheckSum + (&amp;intCharNum * (&amp;i - 1)); End-If; End-For; /* Apply modulo 103 to the weighted total to get the checksum */ &amp;intCheckSum = Mod(&amp;intCheckSum, 103); /* Calculate checksum ASCII code */ If &amp;intCheckSum &lt; 95 Then &amp;intCheckSum = &amp;intCheckSum + 32; Else &amp;intCheckSum = &amp;intCheckSum + 105; End-If; /* Add the checksum and the STOP */ &amp;strBarcode = &amp;strBarcode | Char(&amp;intCheckSum) | Char(211); Return &amp;strBarcode; end-method;" />
<link rel="canonical" href="http://localhost:4000/peoplecode%20barcode%20bar%20code%20code128/2009/05/19/barcode-peoplecode-for-code128.html" />
<meta property="og:url" content="http://localhost:4000/peoplecode%20barcode%20bar%20code%20code128/2009/05/19/barcode-peoplecode-for-code128.html" />
<meta property="og:site_name" content="The PeopleSoft Experience" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2009-05-19T04:05:00+10:00" />
<script type="application/ld+json">
{"description":"/* This class provides methods to : * Assist in development of XML/IB Publisher documents. */class XML_Publisher method XML_Publisher(); method getCode128BarCode(&amp;strDataToFormat As string) Returns string;end-class; /* Method :- Config_Data * Constructor * Arguments :- None. * Returns :- None. */method XML_Publisherend-method; /* USQSF023, Michael Nitschke 06.05.2009 * Method :- GetFieldValues * Arguments :- &amp;strDataToFormat = string to format to code128 format.. * Returns :- Formatted string. *//** * getCode128BarCode * * This function generates Code128 barcode for the given string. It uses subsets B and C when generating barcode * string (not subset A). * @param In &amp;strDataToFormat - string to format into the barcode. * Returns: ASCII characters needed to represent the barcode. * * ASSUMPTIONS: The &amp;strDataToFormat string does not contain any invalid characters. Only ASCII characters 32 to 126 are * allowed - if there are invalid characters, an empty string is returned. The function itself appends the necessary special * ASCII characters to generate the barcode. * * The algorithm for creating barcodes is based upon the sample code provided on this site, with slight modifications: * http://grandzebu.net/index.php?page=/informatique/codbar-en/code128.htm**/method getCode128BarCode /+ &amp;strDataToFormat as String +/ /+ Returns String +/ Local boolean &amp;boolSubsetB = True; Local boolean &amp;boolIsDigits; Local string &amp;strBarcode = &quot;&quot;; Local integer &amp;i; Local integer &amp;intCharNum, &amp;charsToCheck, &amp;intCheckSum; /* While developing... */ rem &amp;strDataToFormat = &quot;123456789012345678901234567890&quot;; /* No need to process an empty string - simply return what was put in */ If Len(&amp;strDataToFormat) = 0 Then Return &amp;strBarcode; End-If; /* Check for valid characters */ For &amp;i = 1 To Len(&amp;strDataToFormat) &amp;intCharNum = Code(Substring(&amp;strDataToFormat, &amp;i, 1)); If &amp;intCharNum &gt;= 32 And &amp;intCharNum &lt;= 126 Then Else /* invalid characters found - return empty string */ Return &quot;&quot;; End-If; End-For; &amp;i = 1; While &amp;i &lt;= Len(&amp;strDataToFormat) If &amp;boolSubsetB Then /* see if it&#39;s worth it to switch to subset C */ /* yes for 4 digits at start or end, else if 6 digits */ If (&amp;i = 1) Or (&amp;i + 3) = Len(&amp;strDataToFormat) Then &amp;charsToCheck = 4; Else &amp;charsToCheck = 6; End-If; &amp;boolIsDigits = False; If IsDigits(Substring(&amp;strDataToFormat, &amp;i, &amp;charsToCheck)) And (Len(Substring(&amp;strDataToFormat, &amp;i, &amp;charsToCheck)) = &amp;charsToCheck) Then &amp;boolIsDigits = True; End-If; If &amp;boolIsDigits Then If &amp;i = 1 Then /* Put Start C character, to indicate barcode starts with subset C */ &amp;strBarcode = Char(210); Else /* Put Code C character, to indicate switch to subset C */ &amp;strBarcode = &amp;strBarcode | Char(204); End-If; &amp;boolSubsetB = False; Else If &amp;i = 1 Then /* Put Start B character, to indicate barcode starts with subset B */ &amp;strBarcode = Char(209); End-If; End-If; End-If; If Not &amp;boolSubsetB Then /* We are on subset C, try to process 2 digits */ &amp;boolIsDigits = False; If IsDigits(Substring(&amp;strDataToFormat, &amp;i, 2)) And (Len(Substring(&amp;strDataToFormat, &amp;i, 2)) = 2) Then &amp;boolIsDigits = True; End-If; If &amp;boolIsDigits Then /* 2 digits - process using subset C */ &amp;intCharNum = Value(Substring(&amp;strDataToFormat, &amp;i, 2)); If &amp;intCharNum = 0 Then &amp;intCharNum = 212; Else If &amp;intCharNum &lt; 95 Then &amp;intCharNum = &amp;intCharNum + 32; Else &amp;intCharNum = &amp;intCharNum + 105; End-If; End-If; &amp;strBarcode = &amp;strBarcode | Char(&amp;intCharNum); &amp;i = &amp;i + 2; Else /* revert back to subset B */ &amp;strBarcode = &amp;strBarcode | Char(205); &amp;boolSubsetB = True; End-If; End-If; If &amp;boolSubsetB Then /* Process 1 digit with subset B */ &amp;strBarcode = &amp;strBarcode | Substring(&amp;strDataToFormat, &amp;i, 1); &amp;i = &amp;i + 1 End-If; End-While; /* Calculation of the checksum */ For &amp;i = 1 To Len(&amp;strBarcode) &amp;intCharNum = Code(Substring(&amp;strBarcode, &amp;i, 1)); If &amp;intCharNum = 212 Then &amp;intCharNum = 0; Else If &amp;intCharNum &lt; 127 Then &amp;intCharNum = &amp;intCharNum - 32; Else &amp;intCharNum = &amp;intCharNum - 105; End-If; End-If; If &amp;i = 1 Then &amp;intCheckSum = &amp;intCharNum; Else &amp;intCheckSum = &amp;intCheckSum + (&amp;intCharNum * (&amp;i - 1)); End-If; End-For; /* Apply modulo 103 to the weighted total to get the checksum */ &amp;intCheckSum = Mod(&amp;intCheckSum, 103); /* Calculate checksum ASCII code */ If &amp;intCheckSum &lt; 95 Then &amp;intCheckSum = &amp;intCheckSum + 32; Else &amp;intCheckSum = &amp;intCheckSum + 105; End-If; /* Add the checksum and the STOP */ &amp;strBarcode = &amp;strBarcode | Char(&amp;intCheckSum) | Char(211); Return &amp;strBarcode; end-method;","@type":"BlogPosting","url":"http://localhost:4000/peoplecode%20barcode%20bar%20code%20code128/2009/05/19/barcode-peoplecode-for-code128.html","headline":"Barcode PeopleCode for code128","dateModified":"2009-05-19T04:05:00+10:00","datePublished":"2009-05-19T04:05:00+10:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/peoplecode%20barcode%20bar%20code%20code128/2009/05/19/barcode-peoplecode-for-code128.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="The PeopleSoft Experience" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">The PeopleSoft Experience</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Barcode PeopleCode for code128</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2009-05-19T04:05:00+10:00" itemprop="datePublished">May 19, 2009
      </time>• <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span class="p-author h-card" itemprop="name">{"login"=>"evlpanda", "email"=>"m.nitschke@gmail.com", "display_name"=>"Michael Nitschke", "first_name"=>"", "last_name"=>""}</span></span></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>/* This class provides methods to :<br /> * Assist in development of XML/IB Publisher documents.<br /> */<br />class XML_Publisher<br />   method XML_Publisher();<br />   method getCode128BarCode(&amp;strDataToFormat As string) Returns string;<br />end-class;</p>
<p>/* Method :- Config_Data<br /> * Constructor<br /> * Arguments :- None.<br /> * Returns :- None.<br /> */<br />method XML_Publisher<br />end-method;</p>
<p>/* USQSF023, Michael Nitschke 06.05.2009<br /> * Method :- GetFieldValues<br /> * Arguments :- &amp;strDataToFormat = string to format to code128 format..<br /> * Returns :- Formatted string.<br /> */<br />/**<br /> * getCode128BarCode<br /> * <br /> * This function generates Code128 barcode for the given string. It uses subsets B and C when generating barcode <br /> * string (not subset A). <br /> * @param In &amp;strDataToFormat - string to format into the barcode.<br /> * Returns: ASCII characters needed to represent the barcode.<br /> *<br /> * ASSUMPTIONS: The &amp;strDataToFormat string does not contain any invalid characters. Only ASCII characters 32 to 126 are<br /> * allowed - if there are invalid characters, an empty string is returned. The function itself appends the necessary special <br /> * ASCII characters to generate the barcode.<br /> *<br /> * The algorithm for creating barcodes is based upon the sample code provided on this site, with slight modifications:<br /> * http://grandzebu.net/index.php?page=/informatique/codbar-en/code128.htm<br />**/<br />method getCode128BarCode<br />   /+ &amp;strDataToFormat as String +/<br />   /+ Returns String +/</p>
<p>   Local boolean &amp;boolSubsetB = True;<br />   Local boolean &amp;boolIsDigits;<br />   Local string &amp;strBarcode = "";<br />   Local integer &amp;i;<br />   Local integer &amp;intCharNum, &amp;charsToCheck, &amp;intCheckSum;</p>
<p>   /* While developing... */<br />   rem &amp;strDataToFormat = "123456789012345678901234567890";</p>
<p>   /* No need to process an empty string - simply return what was put in */<br />   If Len(&amp;strDataToFormat) = 0 Then<br />      Return &amp;strBarcode;<br />   End-If;</p>
<p>   /* Check for valid characters */<br />   For &amp;i = 1 To Len(&amp;strDataToFormat)<br />      &amp;intCharNum = Code(Substring(&amp;strDataToFormat, &amp;i, 1));<br />      If &amp;intCharNum &gt;= 32 And<br />            &amp;intCharNum &lt;= 126 Then<br />      Else<br />         /* invalid characters found - return empty string */<br />         Return "";<br />      End-If;<br />   End-For;</p>
<p>   &amp;i = 1;</p>
<p>   While &amp;i &lt;= Len(&amp;strDataToFormat)</p>
<p>      If &amp;boolSubsetB Then<br />         /* see if it's worth it to switch to subset C */<br />         /* yes for 4 digits at start or end, else if 6 digits */<br />         If (&amp;i = 1) Or<br />               (&amp;i + 3) = Len(&amp;strDataToFormat) Then<br />            &amp;charsToCheck = 4;<br />         Else<br />            &amp;charsToCheck = 6;<br />         End-If;</p>
<p>         &amp;boolIsDigits = False;<br />         If IsDigits(Substring(&amp;strDataToFormat, &amp;i, &amp;charsToCheck)) And<br />               (Len(Substring(&amp;strDataToFormat, &amp;i, &amp;charsToCheck)) = &amp;charsToCheck) Then<br />            &amp;boolIsDigits = True;<br />         End-If;</p>
<p>         If &amp;boolIsDigits Then</p>
<p>            If &amp;i = 1 Then<br />               /* Put Start C character, to indicate barcode starts with subset C */<br />               &amp;strBarcode = Char(210);<br />            Else<br />               /* Put Code C character, to indicate switch to subset C */<br />               &amp;strBarcode = &amp;strBarcode | Char(204);<br />            End-If;<br />            &amp;boolSubsetB = False;</p>
<p>         Else</p>
<p>            If &amp;i = 1 Then<br />               /* Put Start B character, to indicate barcode starts with subset B */<br />               &amp;strBarcode = Char(209);<br />            End-If;</p>
<p>         End-If;</p>
<p>      End-If;</p>
<p>      If Not &amp;boolSubsetB Then</p>
<p>         /* We are on subset C, try to process 2 digits */<br />         &amp;boolIsDigits = False;</p>
<p>         If IsDigits(Substring(&amp;strDataToFormat, &amp;i, 2)) And<br />               (Len(Substring(&amp;strDataToFormat, &amp;i, 2)) = 2) Then<br />            &amp;boolIsDigits = True;<br />         End-If;</p>
<p>         If &amp;boolIsDigits Then<br />            /* 2 digits - process using subset C */<br />            &amp;intCharNum = Value(Substring(&amp;strDataToFormat, &amp;i, 2));<br />            If &amp;intCharNum = 0 Then<br />               &amp;intCharNum = 212;<br />            Else<br />               If &amp;intCharNum &lt; 95 Then<br />                  &amp;intCharNum = &amp;intCharNum + 32;<br />               Else<br />                  &amp;intCharNum = &amp;intCharNum + 105;<br />               End-If;<br />            End-If;</p>
<p>            &amp;strBarcode = &amp;strBarcode | Char(&amp;intCharNum);<br />            &amp;i = &amp;i + 2;</p>
<p>         Else<br />            /* revert back to subset B */<br />            &amp;strBarcode = &amp;strBarcode | Char(205);<br />            &amp;boolSubsetB = True;</p>
<p>         End-If;</p>
<p>      End-If;</p>
<p>      If &amp;boolSubsetB Then</p>
<p>         /* Process 1 digit with subset B */<br />         &amp;strBarcode = &amp;strBarcode | Substring(&amp;strDataToFormat, &amp;i, 1);<br />         &amp;i = &amp;i + 1<br />      End-If;</p>
<p>   End-While;</p>
<p>   /* Calculation of the checksum */<br />   For &amp;i = 1 To Len(&amp;strBarcode)</p>
<p>      &amp;intCharNum = Code(Substring(&amp;strBarcode, &amp;i, 1));<br />      If &amp;intCharNum = 212 Then<br />         &amp;intCharNum = 0;<br />      Else<br />         If &amp;intCharNum &lt; 127 Then<br />            &amp;intCharNum = &amp;intCharNum - 32;<br />         Else<br />            &amp;intCharNum = &amp;intCharNum - 105;<br />         End-If;<br />      End-If;</p>
<p>      If &amp;i = 1 Then<br />         &amp;intCheckSum = &amp;intCharNum;<br />      Else<br />         &amp;intCheckSum = &amp;intCheckSum + (&amp;intCharNum * (&amp;i - 1));<br />      End-If;</p>
<p>   End-For;</p>
<p>   /* Apply modulo 103 to the weighted total to get the checksum */<br />   &amp;intCheckSum = Mod(&amp;intCheckSum, 103);</p>
<p>   /* Calculate checksum ASCII code */<br />   If &amp;intCheckSum &lt; 95 Then<br />      &amp;intCheckSum = &amp;intCheckSum + 32;<br />   Else<br />      &amp;intCheckSum = &amp;intCheckSum + 105;<br />   End-If;</p>
<p>   /* Add the checksum and the STOP */<br />   &amp;strBarcode = &amp;strBarcode | Char(&amp;intCheckSum) | Char(211);</p>
<p>   Return &amp;strBarcode;</p>
<p>end-method;</p>

  </div><a class="u-url" href="/peoplecode%20barcode%20bar%20code%20code128/2009/05/19/barcode-peoplecode-for-code128.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">The PeopleSoft Experience</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">The PeopleSoft Experience</li><li><a class="u-email" href="mailto:your-email@example.com">your-email@example.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/evlPanda"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">evlPanda</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Musings, chit-chat, and sometimes useful stuff related to PeopleSoft, especially PeopleCode.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
